<feed xmlns="http://www.w3.org/2005/Atom"><title>Put some ink into the inkpot</title><link href="https://onemouth.github.io/atom.xml" rel="self" /><link href="https://onemouth.github.io" /><id>https://onemouth.github.io/atom.xml</id><author><name>LT Tsai</name></author><updated>2025-01-04T10:27:33.047834Z</updated><entry><title>åˆä¸€ç¯‡Unicodeçš„å…¥é–€ä»‹ç´¹</title><link href="https://onemouth.github.io/posts/2025-01-04-unicode-intro.html" /><id>https://onemouth.github.io/posts/2025-01-04-unicode-intro.html</id><published>2025-01-04T12:00:00+08:00</published><updated>2025-01-04T12:00:00+08:00</updated><summary type="html"><![CDATA[<main><div><article><h1>åˆä¸€ç¯‡Unicodeçš„å…¥é–€ä»‹ç´¹</h1><section class="header">
Posted on Jan 04, 2025
</section><section><div><div class="toc"><div class="header">Table of Contents</div><ul>
<li><a href="#unicode-ç°¡ä»‹" id="toc-unicode-ç°¡ä»‹"><span class="toc-section-number">1</span> Unicode ç°¡ä»‹</a>
<ul>
<li><a href="#code-planes" id="toc-code-planes"><span class="toc-section-number">1.1</span> Code planes</a></li>
</ul></li>
<li><a href="#encoding" id="toc-encoding"><span class="toc-section-number">2</span> Encoding</a>
<ul>
<li><a href="#utf-32" id="toc-utf-32"><span class="toc-section-number">2.1</span> UTF-32</a></li>
<li><a href="#utf-16" id="toc-utf-16"><span class="toc-section-number">2.2</span> UTF-16</a></li>
<li><a href="#utf-8" id="toc-utf-8"><span class="toc-section-number">2.3</span> UTF-8</a></li>
</ul></li>
<li><a href="#emoji" id="toc-emoji"><span class="toc-section-number">3</span> Emoji</a>
<ul>
<li><a href="#skin-tone-modifier" id="toc-skin-tone-modifier"><span class="toc-section-number">3.1</span> Skin tone modifier</a></li>
<li><a href="#zero-width-joiner-zwj" id="toc-zero-width-joiner-zwj"><span class="toc-section-number">3.2</span> Zero-width joiner (ZWJ)</a></li>
<li><a href="#è®Šé«”é¸æ“‡ç¬¦vs-15-å’Œ-vs-16" id="toc-è®Šé«”é¸æ“‡ç¬¦vs-15-å’Œ-vs-16"><span class="toc-section-number">3.3</span> è®Šé«”é¸æ“‡ç¬¦VS-15 å’Œ VS-16</a></li>
<li><a href="#ç¯„ä¾‹ç¨‹å¼" id="toc-ç¯„ä¾‹ç¨‹å¼"><span class="toc-section-number">3.4</span> ç¯„ä¾‹ç¨‹å¼</a></li>
</ul></li>
<li><a href="#reference" id="toc-reference"><span class="toc-section-number">4</span> Reference</a></li>
</ul></div><div><p>ä¸€ç›´ä»¥ä¾†ï¼Œæˆ‘å°æ–¼Unicodeç¸½æ˜¯è™•æ–¼ä¸€çŸ¥åŠè§£çš„æƒ…æ³ï¼Œå‰›å¥½æœ€è¿‘åœ¨ä¸Š<a href="https://learning.edx.org/course/course-v1:HarvardX+CS50+X/home" title="CS50">CS50</a>ï¼Œåœ¨ç¬¬0è¬›å°±æåˆ°äº†å¦‚ä½•ç”¨0ï¼Œ1ç·¨ç¢¼è¡¨é”æ–‡å­—ï¼Œä¹Ÿå¾ASCIIè¬›åˆ°äº†Unicodeï¼Œæˆ‘ä¹Ÿè¶é€™å€‹æ©Ÿæœƒå¾é ­å­¸ç¿’äº†Unicodeï¼Œä»¥ä¸‹å°±æ˜¯æˆ‘å¾CS50é‚„æœ‰å…¶ä»–ç¶²è·¯è³‡æºå­¸ç¿’åˆ°çš„å…§å®¹ã€‚</p>
<h1 data-number="1" id="unicode-ç°¡ä»‹"><span class="header-section-number">1</span> Unicode ç°¡ä»‹</h1>
<p>Unicodeçš„ç›®æ¨™æ˜¯æä¾›ä¸€å€‹æ–‡å­—ç·¨ç¢¼çš„æ–¹æ¡ˆï¼Œå¯ä»¥åŒ…å«æ‰€æœ‰äººé¡æƒ³è¦æ•¸ä½åŒ–çš„æ–‡å­—ç¬¦è™Ÿã€‚</p>
<p>Unicodeå°‡æ¯å€‹<em>å­—</em>å°æ‡‰åˆ°ä¸€å€‹Code pointã€‚Code point
å¯ä»¥ç°¡å–®ç†è§£ç‚ºä¸€å€‹æ•¸å­—ï¼Œç‚ºäº†æ–¹ä¾¿èµ·è¦‹ï¼Œæ…£ä¾‹ç”¨16é€²ä½è¡¨ç¤ºé€™å€‹æ•¸å­—ã€‚ä¾‹å¦‚ğŸ˜‚
å°æ‡‰åˆ°çš„æ˜¯U+1F602é€™å€‹æ•¸å­—ã€‚</p>
<p>å› ç‚ºå¯åŒ…å«çš„æ–‡å­—ç¬¦è™Ÿå¾ˆå¤šï¼ŒUnicodeæŠŠå¯ä»¥ç·¨ç¢¼çš„æ–‡å­—ç¬¦è™ŸåŠƒåˆ†ç‚º17å€‹Code
Planeï¼Œæ¯å€‹ Plane åˆåŒ…å«äº†65536å€‹Code Pointã€‚æ‰€ä»¥ Unicode
å¯ä»¥å›Šæ‹¬çš„æ–‡å­—ä¸Šé™ç‚º 65536 *&nbsp;17 =1,114,112 å€‹æ–‡å­—ã€‚</p>
<h2 data-number="1.1" id="code-planes"><span class="header-section-number">1.1</span> Code planes</h2>
<p>Plane çš„ç·¨è™Ÿå¾0åˆ°16ï¼Œå…±17å€‹ã€‚å…¶ä¸­æœ€é‡è¦çš„æ˜¯<em>Plane
0</em>ï¼Œä¹Ÿç¨±ç‚º<strong>BMP</strong> (Basic Multilingual
Plane)ã€‚å¤§éƒ¨åˆ†èªè¨€çš„å¸¸ç”¨å­—ç¬¦ï¼Œéƒ½åŒ…å«åœ¨BMPè£¡é¢ï¼Œå¸¸ç”¨çš„CJKæ–‡å­—ä¹Ÿåœ¨BMPè£¡é¢ã€‚BMPçš„ç¯„åœæ˜¯å¾0000åˆ°FFFFï¼Œä¹Ÿå°±æ˜¯èƒ½ç”¨2å€‹byteè¡¨ç¤ºçš„ç¯„åœã€‚</p>
<p>å…¶ä»–çš„Planeå¤§è‡´å¯ç¨±ç‚º Supplementary Planesï¼Œè©³ç´°çš„åŠƒåˆ†å¯ä»¥åƒè€ƒ<a href="https://en.wikipedia.org/wiki/Plane_(Unicode)" title="Plane (Unicode)">ç¶­åŸºé é¢</a>ã€‚</p>
<h3 data-number="1.1.1" id="bmps-surrogate-area"><span class="header-section-number">1.1.1</span> BMPâ€™s Surrogate area</h3>
<p>åœ¨BMPä¸­æœ‰ä¸€å¡Šç¯„åœå¾ U+D800 åˆ°U+DFFFï¼Œé€™å€‹ç¯„åœè¢«ç¨±ç‚ºSurrogate areaã€‚
Surrogate area
æ˜¯ä¸€å¡Šä¿ç•™å€ï¼Œä¸æœƒæœ‰ä»»ä½•å­—ç¬¦è¢«æŒ‡å®šåˆ°é€™å€‹å€åŸŸï¼Œå®ƒçš„ä¸»è¦åŠŸèƒ½æ˜¯è®“UTF-16
å¯ä»¥ç”¨é€™å¡Šå€åŸŸå»ç·¨ç¢¼è¶…é2byte å¤§å°çš„code pointã€‚</p>
<p>Surrogate area å¯ä»¥å†åˆ†ç‚ºHigh Surrogate å’Œ Low Surrogateã€‚ High
Surrogate çš„ç¯„åœæ˜¯å¾ <code>U+D800</code> åˆ° <code>U+DBFF</code>ï¼Œè€Œ Low
Surrogateçš„ç¯„åœæ˜¯å¾<code>U+DC00</code> åˆ° <code>U+DFFF</code> ã€‚
ä¸é›£çœ‹å‡º, High Surrogate å’Œ Low Surrogate çš„å¤§å°éƒ½æ˜¯ 4
<em>&nbsp;256ï¼Œæ‰€ä»¥ç•¶æˆ‘å€‘æŠŠ High Surrogate å’Œ Low Surrogate
çµ„åˆèµ·ä¾†çš„è©±ï¼Œå°±å¯ä»¥å¾—åˆ°4</em>256<em>4</em>256 ç¨®å¯èƒ½ï¼Œç­‰æ–¼
16*65536ï¼Œä¹Ÿå°±æ˜¯ Plane 1 åˆ° Plane 16æ‰€éœ€è¦çš„å€‹æ•¸ï¼</p>
<h1 data-number="2" id="encoding"><span class="header-section-number">2</span> Encoding</h1>
<p>é›–ç„¶æˆ‘å€‘å®šç¾©äº†Code pointï¼Œä½†Code point
åªæ˜¯ä¸€å€‹æ•¸å­—ï¼Œæ¥ä¸‹ä¾†ï¼Œæˆ‘å€‘é‚„éœ€è¦ç·¨ç¢¼é€™å€‹æ•¸å­—ï¼Œè®“é›»è…¦å¯ä»¥è®€å–ã€‚ç·¨ç¢¼çš„æ–¹æ³•æœ‰å¾ˆå¤šç¨®ï¼Œä¹Ÿå„è‡ªæœ‰å„ªç¼ºé»ï¼Œç¾åœ¨æœ€å¸¸è¦‹çš„3ç¨®æ˜¯UTF-32,
UTF-16, å’ŒUTF-8ã€‚</p>
<h2 data-number="2.1" id="utf-32"><span class="header-section-number">2.1</span> UTF-32</h2>
<p>UTF-32 ç°¡å–®æš´åŠ›ï¼Œå› ç‚ºæ¯å€‹Unicode code point
å…¶å¯¦åªéœ€è¦21å€‹bitå°±å¯ä»¥è¡¨ç¤ºå‡ºä¾†ï¼ŒUTF-32ç›´æ¥ç”¨32å€‹bitè¡¨ç¤ºï¼Œå¤šå‡ºä¾†çš„11å€‹bitå°±ç›´æ¥è£œ0ã€‚</p>
<p>å¥½è™•æ˜¯æœ‰å…©å€‹ï¼Œç¬¬ä¸€å€‹å¥½è™•æ˜¯code point å’Œ binary number
ç›´æ¥å°æ‡‰ï¼Œä¸éœ€è¦é¡å¤–çš„è¤‡é›œencoding
è¦å‰‡ã€‚å»¶ä¼¸å‡ºä¾†çš„ç¬¬äºŒå€‹å¥½è™•å°±æ˜¯UTF-32æ˜¯ä¸€å€‹å›ºå®šé•·åº¦çš„ç·¨ç¢¼ï¼Œæ‰€ä»¥æˆ‘å€‘è¦æ‰¾åˆ°æŸå€‹å­—ä¸²çš„ç¬¬Nå€‹å­—ï¼Œå‡å¦‚å­—ä¸²æ˜¯UTF-32ç·¨ç¢¼ï¼Œå°±å¯ä»¥åœ¨å¸¸æ•¸æ™‚é–“æ‰¾åˆ°ï¼Œä½†è¦æ³¨æ„çš„æ˜¯ï¼Œç¾åœ¨çš„Unicodeç·¨ç¢¼æœ‰åƒSkin
tone modifier, Zero-width joiner
ç­‰ä¿®é£¾å­—ç¬¦ï¼Œæ‰€ä»¥é€™å€‹å¸¸æ•¸æ™‚é–“å®šä½ï¼Œä¹Ÿæœªå¿…èƒ½è·Ÿçœ¼ç›æ‰€è¦‹çš„ã€è¢å¹•ä¸Šé¡¯ç¤ºçš„å­—ç¬¦åšä¸€å°ä¸€çš„å®šä½ã€‚</p>
<p>å£è™•ä¹Ÿå¾ˆé¡¯è€Œæ˜“è¦‹ï¼Œå°±æ˜¯ç©ºé–“çš„æµªè²»ï¼Œå°¤å…¶æˆ‘å€‘ä¹‹å‰æåˆ°ï¼Œå¸¸ç”¨å­—éƒ½åœ¨BMPï¼Œåªéœ€è¦2
bytes å°±å¯ä»¥è¡¨ç¤ºï¼ŒUTF-32å»ä¸€å¾‹éƒ½ä½¿ç”¨äº†4
bytesã€‚å¦å¤–ä¸€å€‹å•é¡Œæ˜¯å¯èƒ½éœ€è¦BOM(Byte Order
Mark)ï¼Œä¾†ç¢ºå®šä½å…ƒé †åºæ˜¯little-endian é‚„æ˜¯ big-endianã€‚
å› ç‚ºç©ºé–“çš„æµªè²»ï¼Œæ‰€ä»¥UTF-32åœ¨å¯¦å‹™ä¸Šæ¯”èµ·UTF-16ï¼ŒUTF-8ä¾†èªªå¾ˆå°‘ä½¿ç”¨ã€‚</p>
<p>å¦å¤–ï¼Œåœ¨æœ‰äº›æ–‡ç»å¯èƒ½æœƒæåˆ°UCF-4é€™å€‹è©ï¼Œç°¡å–®ä¾†èªªUTF-32è·ŸUCF-4æ˜¯ä¸€æ¨£çš„æ±è¥¿ï¼Œåªæ˜¯åç¨±ä¸Šçš„å·®ç•°ã€‚</p>
<h2 data-number="2.2" id="utf-16"><span class="header-section-number">2.2</span> UTF-16</h2>
<p>UTF-16 ç”¨å…©å€‹byteç·¨ç¢¼BMPï¼Œå°æ–¼å…¶ä»–planeï¼Œå‰‡ç”¨ä¸Šè¿°æåˆ°éçš„Surrogate
areaä¾†ç·¨ç¢¼ï¼Œä¹Ÿå°±æ˜¯èªªï¼Œåœ¨BMPä¹‹å…§çš„å­—ç¬¦ï¼Œæœƒæ˜¯2å€‹bytesé•·ï¼ŒBMPä¹‹å¤–çš„å­—ç¬¦ï¼Œå‰‡æœƒæ˜¯4å€‹bytes
é•·ã€‚</p>
<p>å¥½è™•æ˜¯å¸¸ç”¨å­—ç¬¦(BMP)éƒ½åªéœ€è¦2å€‹bytesï¼Œç¯€çœç©ºé–“ã€‚å£è™•æ˜¯ä¸å…¼å®¹ASCII,
åŸå…ˆç”¨ASCIIè¡¨ç¤ºçš„è©±ï¼Œåªéœ€è¦1 byte çš„è‹±æ–‡å­—æ¯ï¼Œç”¨UTF-16å‰‡éœ€è¦2 bytesã€‚
å¦å¤–ä¹Ÿéœ€è¦ BMP ä¾†ç¢ºå®šä½å…ƒé †åºã€‚</p>
<p>åœ¨æœ‰äº›åœ°æ–¹å¯ä»¥çœ‹åˆ°USC-2é€™å€‹è©ï¼Œå¯ä»¥æŠŠUSC-2ç·¨ç¢¼è¦–ç‚ºä¸æ”¯æŒSurrogate
areaçš„UTF-16,ä¹Ÿå°±æ˜¯èªªï¼ŒUSC-2 åªæœƒæœ‰2 bytesè€Œä¸”åªèƒ½è™•ç†BMPæœ‰çš„å­—ç¬¦ã€‚</p>
<h2 data-number="2.3" id="utf-8"><span class="header-section-number">2.3</span> UTF-8</h2>
<p>UTF-8 çš„ç‰¹è‰²å°±æ˜¯ç›¸å®¹<a href="https://zh.wikipedia.org/zh-tw/ASCII">ASCII</a>ï¼Œæ‰€ä»¥åªéœ€è¦1
byteå°±èƒ½è¡¨ç¤ºè‹±æ–‡å­—æ¯ï¼Œå°æ–¼ç›¸å®¹åªæ”¯æ´ASCIIçš„èˆŠç³»çµ±ä¹Ÿç›¸ç•¶æ–¹ä¾¿ã€‚
å¦å¤–ï¼ŒUTF-8åœ¨è¨­è¨ˆä¸Šä¸éœ€è¦BOMã€‚ç¼ºé»æ˜¯å°CJKçš„ç·¨ç¢¼éœ€è¦3 bytesã€‚</p>
<h3 data-number="2.3.1" id="ç·¨ç¢¼è¦å‰‡"><span class="header-section-number">2.3.1</span> ç·¨ç¢¼è¦å‰‡</h3>
<p>1 byteçš„æƒ…æ³ï¼š1 byte å®Œå…¨ç›¸å®¹ ASCIIï¼Œç‚º <code>0xxxxxxx</code>
æ ¼å¼ï¼Œåªè¦byteçš„ç¬¬1å€‹ bit æ˜¯ 0, å°±ä¸€å®šæ˜¯ ASCIIã€‚</p>
<p>å¤šå€‹bytes çš„æƒ…æ³:
ç¬¬ä¸€å€‹byteçš„é–‹å§‹æœ‰é€£çºŒå¹¾å€‹1ï¼Œå°±æ˜¯ä»£è¡¨é€™çµ„ç¸½å…±æœ‰å¹¾å€‹bytesã€‚ ä¸”ç¬¬ä¸€å€‹ byte
ä¹‹å¾ŒåŒä¸€çµ„çš„byteï¼Œéƒ½æœƒæ˜¯ <code>10xxxxxx&nbsp;</code> æ ¼å¼ã€‚</p>
<ul>
<li>2 bytes: <code>110xxxxx 10xxxxxx</code></li>
<li>3 bytes: <code>1110xxxx 10xxxxxx 10xxxxxx</code></li>
<li>4 bytes: <code>11110xxx 10xxxxxx 10xxxxxx 10xxxxxx</code></li>
</ul>
<p>ç°¡å–®ç®—ä¸€ä¸‹ï¼Œ2 bytes å¯ä»¥åŒ…å« 2^11 =2,048 å€‹ code pointsã€‚ 3 bytes
å¯ä»¥åŒ…å« 2^16=65,536 å€‹ code points (1 å€‹ plane çš„å¤§å°) 4 bytes å¯ä»¥åŒ…å«
2^21=2,097,152 å€‹ code points (æ•´å€‹ unicode çš„å¤§å°)</p>
<h3 data-number="2.3.2" id="mysql-çš„æ•…äº‹"><span class="header-section-number">2.3.2</span> MySQL çš„æ•…äº‹</h3>
<p>MySQL è£¡é¢æœ‰ utfmb3 ç·¨ç¢¼è·Ÿ utfmb4 ç·¨ç¢¼ï¼ŒåŸºæœ¬ä¸Šutfmb3
æ˜¯ä¸€å€‹å¯¦ä½œä¸Šçš„éŒ¯èª¤ï¼Œå®ƒé›–ç„¶æ˜¯utf-8ç·¨ç¢¼å»æœ€å¤šåªèƒ½æœ‰3å€‹byteï¼Œç„¡æ³•æ­£ç¢ºå­˜æ”¾æ‰€æœ‰Unicodeã€‚ä¹Ÿå› æ­¤ï¼Œåœ¨ä½¿ç”¨
Mysql çš„utf ç·¨ç¢¼æ™‚ï¼Œå‹™å¿…è¦ä½¿ç”¨utfmb4 ç·¨ç¢¼ã€‚</p>
<h1 data-number="3" id="emoji"><span class="header-section-number">3</span> Emoji</h1>
<p>Unicodeä¹ŸåŒ…å«äº†å¤§å®¶å–œæ­¡çš„è¡¨æƒ…ç¬¦è™Ÿemojiï¼Œä¾‹å¦‚ğŸ˜‚ğŸ˜­ç­‰ç­‰ï¼Œæ˜¯åœ¨ç¶²è·¯ä¸Šèˆ‡äººäº¤æµä¸å¯æˆ–ç¼ºçš„å·¥å…·ã€‚å› ç‚ºemojiå¤ªå¥½ç”¨äº†ï¼Œæ‰€ä»¥å¤§å®¶å°±æƒ³åŠ è¶Šä¾†è¶Šå¤šçš„emojiåˆ°Unicodeè£¡ï¼Œåƒæ˜¯å„ç¨®è†šè‰²çš„emoji
ğŸ‘
ğŸ‘ğŸ»ï¼Œæˆ–æ˜¯å¸¶è‘—ç­†é›»çš„ç”·äººğŸ‘¨ğŸ½â€ğŸ’»ï¼Œæˆ–æ˜¯æœ‰è‘—ç´…é ­é«®çš„å¥³äººğŸ‘©ğŸ»â€ğŸ¦°â€¦â€¦ç­‰ç­‰ã€‚é€™äº›emojiçš„è†šè‰²æˆ–æ”œå¸¶ç‰©å“æˆ–é«®å‹ï¼Œå¯ä»¥æœ‰å„ç¨®çµ„åˆï¼Œå‡å¦‚æ¯å€‹çµ„åˆéƒ½æ˜¯ä¸€å€‹ç¨ç«‹çš„emojiï¼Œé‚£æˆ‘å€‘çš„Unicodeå°±ä¸å¤ ç”¨äº†ï¼Œç‚ºäº†é¿å…é€™å€‹å•é¡Œï¼Œæˆ‘å€‘å°±æœ‰äº†Skin
tone modifier, ZWJ ç­‰ç‰¹æ®Šå­—å…ƒï¼Œä¾†è§£æ±ºemojiçš„çµ„åˆå•é¡Œã€‚</p>
<h2 data-number="3.1" id="skin-tone-modifier"><span class="header-section-number">3.1</span> Skin tone modifier</h2>
<p>Skin tone modifier
ç¸½å…±æœ‰5å€‹ï¼Œå®ƒå¯ä»¥æ”¹è®Šemojiçš„è†šè‰²ï¼Œç¸½å…±æœ‰5å€‹ï¼Œåˆ†åˆ¥æ˜¯</p>
<ul>
<li><code>U+1F3FB</code> ğŸ»</li>
<li><code>U+1F3FC</code> ğŸ¼</li>
<li><code>U+1F3FD</code> ğŸ½</li>
<li><code>U+1F3FE</code> ğŸ¾</li>
<li><code>U+1F3FF</code> ğŸ¿</li>
</ul>
<p>æŠŠå®ƒåŠ åœ¨åŸä¾†emojiçš„å¾Œé¢ï¼Œå°±å¯ä»¥æ”¹è®Šemojiçš„è†šè‰²ã€‚ä¾‹å¦‚
<code>U+1F44D</code> æ˜¯é è¨­é»ƒè‰²çš„ğŸ‘ï¼Œ<code>U+1F44D U+1F3FB</code>
å°±æœƒè®Šæˆæ·ºçš®è†šè‰²çš„ğŸ‘ğŸ»ã€‚</p>
<h2 data-number="3.2" id="zero-width-joiner-zwj"><span class="header-section-number">3.2</span> Zero-width joiner (ZWJ)</h2>
<p>ZWJ(<code>U+200D</code>)å¯ä»¥çµåˆå¤šå€‹emojiè€Œç”¢ç”Ÿå‡ºä¸€å€‹æ–°çš„emojiï¼Œåˆ©ç”¨ZWJï¼Œæˆ‘å€‘å¯ä»¥ç”¨åŸæœ‰çš„emojiç‚ºåŸºç¤ï¼Œè€Œå®šç¾©å‡ºæ–°çš„emojiã€‚ä¾‹å¦‚ç•¶æˆ‘å€‘æƒ³è¦æœ‰ä¸€å€‹emojiæ˜¯ç´…é ­é«®çš„æ·ºçš®è†šå¥³æ€§ï¼Œå°±å¯ä»¥æœ‰ä»¥ä¸‹Unicodeé †åºï¼š<code>U+1F469 U+1F3FB U+200D U+1F9B0&nbsp;</code></p>
<ul>
<li><code>U+1F469 U+1F3FB&nbsp;</code>: ğŸ‘©ğŸ»</li>
<li><code>U+200D</code>: ZWJ</li>
<li><code>U+1F9B0</code>: ğŸ¦°</li>
</ul>
<p>æ‰€ä»¥åˆèµ·ä¾†å°±æœƒå¾—åˆ°ï¼š ğŸ‘©ğŸ»â€ğŸ¦°</p>
<h2 data-number="3.3" id="è®Šé«”é¸æ“‡ç¬¦vs-15-å’Œ-vs-16"><span class="header-section-number">3.3</span> è®Šé«”é¸æ“‡ç¬¦VS-15 å’Œ VS-16</h2>
<p>åœ¨Unicodeä¸­æœ‰æ‰€è¬‚çš„è®Šé«”é¸æ“‡ç¬¦(Variation Selector)ï¼Œå…¶ä¸­çš„VS-15
(<code>U+FE0E</code>)å’ŒVS-16(<code>U+FE0F</code>)æ˜¯å°ˆå±¬æ–¼emojiä½¿ç”¨çš„ã€‚
VS-15è¡¨ç¤ºè¦ç”¨å–®è‰²çš„æ–¹å¼é¡¯ç¤ºemojiï¼ŒVS-16å‰‡è¡¨ç¤ºè¦ç”¨å½©è‰²çš„æ–¹å¼ä¾†é¡¯ç¤ºemojiã€‚ä»¥ä¸‹æ˜¯ä¸€å€‹ä¾‹å­ï¼š(ä¸åŒå¹³å°å‘ˆç¾çš„æ•ˆæœå¯èƒ½ä¸åŒ)</p>
<ul>
<li>â˜• (<code>U+2615</code>)</li>
<li>â˜•ï¸ (<code>U+2615 U+FE0E</code>)</li>
<li>â˜•ï¸ (<code>U+2615 U+FE0F</code>)</li>
</ul>
<h2 data-number="3.4" id="ç¯„ä¾‹ç¨‹å¼"><span class="header-section-number">3.4</span> ç¯„ä¾‹ç¨‹å¼</h2>
<p>å¯«äº†ä¸€å€‹ç°¡å–®ç¨‹å¼ï¼Œå¯ä»¥demoä¸Šé¢çš„ä¾‹å­ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥è‡ªè¡Œä¿®æ”¹ä¾†ç©ç©ï¼Œåªè¦è£<a href="https://babashka.org/">Babashka</a> å°±å¯ä»¥åŸ·è¡Œäº†ã€‚</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode clojure"><code class="sourceCode clojure"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> light-skin </span><span class="bn">0x1F3FB</span>)</span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> medium-light-skin </span><span class="bn">0x1F3FC</span>)</span>
<span id="cb1-3"><a aria-hidden="true" href="#cb1-3" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> medium-skin </span><span class="bn">0x1F3FD</span>)</span>
<span id="cb1-4"><a aria-hidden="true" href="#cb1-4" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> medium-dark-skin </span><span class="bn">0x1F3FE</span>)</span>
<span id="cb1-5"><a aria-hidden="true" href="#cb1-5" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> dark-skin </span><span class="bn">0x1F3FF</span>)</span>
<span id="cb1-6"><a aria-hidden="true" href="#cb1-6" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> thumb </span><span class="bn">0x1F44D</span>)</span>
<span id="cb1-7"><a aria-hidden="true" href="#cb1-7" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> thumb-light-skin </span>[thumb light-skin])</span>
<span id="cb1-8"><a aria-hidden="true" href="#cb1-8" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> man-with-computer </span>[<span class="bn">0x1F468</span> <span class="bn">0x1F3FD</span> <span class="bn">0x200D</span> <span class="bn">0x1F4BB</span>])</span>
<span id="cb1-9"><a aria-hidden="true" href="#cb1-9" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> woman-with-light-skin </span>[<span class="bn">0x1F469</span> <span class="bn">0x1F3FB</span>])</span>
<span id="cb1-10"><a aria-hidden="true" href="#cb1-10" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> woman-with-redhair </span>[<span class="bn">0x1F469</span> <span class="bn">0x1F3FB</span> <span class="bn">0x200D</span> <span class="bn">0x1F9B0</span>])</span>
<span id="cb1-11"><a aria-hidden="true" href="#cb1-11" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> coffee </span><span class="bn">0x2615</span>)</span>
<span id="cb1-12"><a aria-hidden="true" href="#cb1-12" tabindex="-1"></a></span>
<span id="cb1-13"><a aria-hidden="true" href="#cb1-13" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> merge-to-chars </span>[code-points]</span>
<span id="cb1-14"><a aria-hidden="true" href="#cb1-14" tabindex="-1"></a>  (<span class="kw">let</span> [char-arrays (<span class="kw">map</span> #(Character/toChars <span class="va">%</span>) code-points)]</span>
<span id="cb1-15"><a aria-hidden="true" href="#cb1-15" tabindex="-1"></a>    (String. (<span class="kw">char-array</span> (<span class="kw">apply</span> <span class="kw">concat</span> char-arrays)))))</span>
<span id="cb1-16"><a aria-hidden="true" href="#cb1-16" tabindex="-1"></a></span>
<span id="cb1-17"><a aria-hidden="true" href="#cb1-17" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> show </span>[&amp; code-point-groups]</span>
<span id="cb1-18"><a aria-hidden="true" href="#cb1-18" tabindex="-1"></a>  (<span class="kw">doseq</span> [group code-point-groups]</span>
<span id="cb1-19"><a aria-hidden="true" href="#cb1-19" tabindex="-1"></a>      (<span class="kw">print</span> (merge-to-chars group)))</span>
<span id="cb1-20"><a aria-hidden="true" href="#cb1-20" tabindex="-1"></a>  (<span class="kw">println</span>))</span>
<span id="cb1-21"><a aria-hidden="true" href="#cb1-21" tabindex="-1"></a></span>
<span id="cb1-22"><a aria-hidden="true" href="#cb1-22" tabindex="-1"></a>(show [thumb] thumb-light-skin)</span>
<span id="cb1-23"><a aria-hidden="true" href="#cb1-23" tabindex="-1"></a>(show man-with-computer woman-with-light-skin woman-with-redhair)</span>
<span id="cb1-24"><a aria-hidden="true" href="#cb1-24" tabindex="-1"></a>(show [light-skin medium-light-skin medium-skin medium-dark-skin dark-skin])</span>
<span id="cb1-25"><a aria-hidden="true" href="#cb1-25" tabindex="-1"></a>(show [coffee] [coffee <span class="bn">0xFE0E</span>] [coffee <span class="bn">0xFE0F</span>])</span></code></pre></div>
<h1 data-number="4" id="reference"><span class="header-section-number">4</span> Reference</h1>
<ol type="1">
<li><a href="https://medium.com/@angus258963/%E5%BE%9Eunicode%E5%88%B0emoji-8cab765f55d9">å¾
Unicode åˆ° Emoji&nbsp;</a></li>
</ol></div></div></section></article><comment><script async="async" crossorigin="anonymous" data-category="General" data-category-id="DIC_kwDOD5Bpa84COAIg" data-emit-metadata="0" data-input-position="top" data-lang="en" data-mapping="pathname" data-reactions-enabled="0" data-repo="onemouth/onemouth.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkyNjExMjI0MTE=" data-theme="light" src="https://giscus.app/client.js"></script><script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script></comment></div></main>
]]></summary></entry><entry><title>å±±é™°å±±é™½æ—…è¡Œæœ€å–œæ­¡çš„ä¸‰å®¶åº—</title><link href="https://onemouth.github.io/posts/2023-09-24-jp-okayama-trip.html" /><id>https://onemouth.github.io/posts/2023-09-24-jp-okayama-trip.html</id><published>2023-09-24T12:00:00+08:00</published><updated>2023-09-24T12:00:00+08:00</updated><summary type="html"><![CDATA[<main><div><article><h1>å±±é™°å±±é™½æ—…è¡Œæœ€å–œæ­¡çš„ä¸‰å®¶åº—</h1><section class="header">
Posted on Sep 24, 2023
by LT
</section><section><div><div class="toc"><div class="header">Table of Contents</div><ul>
<li><a href="#æœ‰é„°åºµ" id="toc-æœ‰é„°åºµ"><span class="toc-section-number">1</span> æœ‰é„°åºµ</a></li>
<li><a href="#éš å²-ãŠãã®å³¶ãƒ©ãƒ¼ãƒ¡ãƒ³" id="toc-éš å²-ãŠãã®å³¶ãƒ©ãƒ¼ãƒ¡ãƒ³"><span class="toc-section-number">2</span>
<ruby>éš å² <rt>ãŠã</rt></ruby>ã®å³¶ãƒ©ãƒ¼ãƒ¡ãƒ³</a></li>
<li><a href="#å€‰å¼çˆç²åº—" id="toc-å€‰å¼çˆç²åº—"><span class="toc-section-number">3</span> å€‰å¼çˆç²åº—</a></li>
</ul></div><div><p>æœ€è¿‘å»äº†æ—¥æœ¬çš„å±±é™°å±±é™½åœ°å€æ—…è¡Œï¼Œæƒ³ç´€éŒ„ä¸€ä¸‹éç¨‹ä¸­æˆ‘æœ€å–œæ­¡çš„3å®¶é¤å»³ã€‚</p>
<h1 data-number="1" id="æœ‰é„°åºµ"><span class="header-section-number">1</span> æœ‰é„°åºµ</h1>
<p>ä½æ–¼å€‰æ•·ç¾è§€åœ°å€ï¼Œæ˜¯åœ¨ç¶²è·¯ä¸Šä¹Ÿååˆ†æœ‰åçš„åº—ï¼Œå‡æ—¥å¾€å¾€å¤§æ’é•·é¾ï¼Œæˆ‘æ˜¯è¶å¹³æ—¥ï¼Œè¶•åœ¨é–‹é–€çš„11é»å°±åˆ°åº—é¢å£ã€‚</p>
<p>æˆ‘é»çš„æ˜¯ç”Ÿè›‹æ‹Œé£¯åŠ å¸ƒä¸åŠ æ¡ƒå­æœæ±çš„å¥—é¤ã€‚åº—å“¡çš„æ¥å¾…å¾ˆè¦ªåˆ‡ï¼Œæœ‰è¶£çš„æ˜¯ï¼Œä¸ç®¡æ˜¯ç”Ÿè›‹æ‹Œé£¯é‚„æ˜¯å¸ƒä¸ã€æ¡ƒå­æœæ±ï¼Œå±…ç„¶éƒ½æœ‰èªªæ˜æ›¸ï¼Œé‚„æ˜¯ä¸­æ–‡æ‰‹å¯«çš„ã€‚</p>
<p>ç”Ÿè›‹æ‹Œé£¯çš„è›‹å’Œé£¯éƒ½å¯ä»¥çºŒï¼Œå¸ƒä¸å’Œæ¡ƒå­æœæ±ä¹Ÿéƒ½éå¸¸é©åˆæ•´å®¶åº—çš„æ°›åœï¼Œ</p>
<h1 data-number="2" id="éš å²-ãŠãã®å³¶ãƒ©ãƒ¼ãƒ¡ãƒ³"><span class="header-section-number">2</span> <ruby>éš å²
<rt>ãŠã</rt></ruby>ã®å³¶ãƒ©ãƒ¼ãƒ¡ãƒ³</h1>
<p><img src="/images/okinoshimaramen.jpeg"></p>
<p><a href="https://tabelog.com/okayama/A3301/A330101/33014542/">tableogçš„é é¢</a>ã€‚</p>
<p>æˆ‘æ˜¯é»æ¿ƒåšè²å‡ºæ±çš„å£å‘³ï¼Œè²é¡çš„æ¹¯é ­å¯¦åœ¨å¤ªä»¤äººé©šè‰·ï¼Œè®“æˆ‘æƒ³èµ·ç¬¬ä¸€æ¬¡åƒåˆ°è±šéª¨æ‹‰éºµçš„æ„Ÿè¦ºï¼Œé‚£æ˜¯æœ‰ç”Ÿä»¥ä¾†ç¬¬ä¸€æ¬¡ç™¼ç¾æ¹¯éºµé‚„èƒ½æœ‰é€™ç¨®æ¹¯é ­çš„æ„Ÿå‹•ã€‚</p>
<p><img src="/images/kaidashi.jpeg"></p>
<p>çµ•å°æ¨è–¦ï¼Œåˆ°å²¡å±±ä¸€å®šè¦åƒã€‚</p>
<h1 data-number="3" id="å€‰å¼çˆç²åº—"><span class="header-section-number">3</span> å€‰å¼çˆç²åº—</h1>
<p>å¾ˆæœ‰æ‡·èˆŠ(ãƒ¬ãƒˆãƒ­)æ°£æ°›çš„å’–å•¡åº—ï¼Œç‰¹è‰²æ˜¯æœƒçµ¦æ¯ä½å®¢äººä¸€å£ºè³½é¢¨å£ºå’–å•¡ï¼Œé‡è¶³å¤ å€’å…©æ¯å’–å•¡ï¼Œå¯ä»¥æ‚ é–’çš„åº¦éä¸€æ®µæ™‚å…‰ã€‚</p>
<p><img src="/images/kurashikicafe.jpeg"></p>
<p>æˆ‘å»çš„åº—æ˜¯åœ¨å²¡å±±Aeonçš„ä¸€æ¨“ï¼Œè€Œä¸”å…¶å¯¦æˆ‘çš„é£¯åº—å°±åœ¨Aeonæ—é‚Šï¼Œä½†æˆ‘å‰å¹¾å¤©è·¯ééƒ½æ²’é€²å»ï¼Œç›´åˆ°æœ€å¾Œä¸€å¤©æ‰é€²å»åƒæ—©é¤ï¼Œéå¸¸å–œæ­¡ï¼Œå¾Œæ‚”æ²’æœ‰å‰å¹¾å¤©æ‰¾æ™‚é–“å¤šä¾†å¹¾è¶Ÿã€‚</p>
<p>åœ¨æ—¥æœ¬å…¨åœ‹å„åœ°éƒ½æœ‰<a href="https://www.saint-marc-hd.com/kurashiki/search_index/">é€£é–</a>ï¼Œæ¨è–¦æœ‰è·¯éçš„æ™‚å€™ï¼Œé †é“é€ è¨ªï¼Œäº«å—ä¸€æ¯å’–å•¡ã€‚</p></div></div></section></article><comment><script async="async" crossorigin="anonymous" data-category="General" data-category-id="DIC_kwDOD5Bpa84COAIg" data-emit-metadata="0" data-input-position="top" data-lang="en" data-mapping="pathname" data-reactions-enabled="0" data-repo="onemouth/onemouth.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkyNjExMjI0MTE=" data-theme="light" src="https://giscus.app/client.js"></script><script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script></comment></div></main>
]]></summary></entry><entry><title>Write myself a static site generator</title><link href="https://onemouth.github.io/posts/2023-03-20-new-blog-system.html" /><id>https://onemouth.github.io/posts/2023-03-20-new-blog-system.html</id><published>2023-03-20T12:00:00+08:00</published><updated>2023-03-20T12:00:00+08:00</updated><summary type="html"><![CDATA[<main><div><article><h1>Write
myself a static site generator</h1><section class="header">
Posted on Mar 20, 2023
by LT
</section><section><div><div class="toc"><div class="header">Table of Contents</div><ul>
<li><a href="#hakyll" id="toc-hakyll"><span class="toc-section-number">1</span> Hakyll</a></li>
<li><a href="#babashka" id="toc-babashka"><span class="toc-section-number">2</span> Babashka</a></li>
<li><a href="#conclustion" id="toc-conclustion"><span class="toc-section-number">3</span> Conclustion</a></li>
</ul></div><div><p>Originally this blog was generated using <a href="https://jaspervdj.be/hakyll">Hakyll</a>, but after using it for a
while, although I liked its concise and simple design, I still found
some aspects didnâ€™t quite suit my needs. Recently, I happened to
discover <a href="https://babashka.org">Babashka</a>, and I thought I
could use Babashka and Pandoc CLI to implement the functionalities I
used in Hakyll. This blog post mainly introduces my implementation. My
implementation repository can be found <a href="https://github.com/onemouth/blog-source">here</a>.</p>
<h1 data-number="1" id="hakyll"><span class="header-section-number">1</span> Hakyll</h1>
<p>First, Iâ€™d like to explain how Hakyll, the tool I used to use, works.
Hakyll is a library written in Haskell that provides helper functions
for creating static websites. It uses another library called <a href="https://hackage.haskell.org/package/pandoc">Pandoc</a> to generate
HTML files, and you can check out the Hakyll website
(https://jaspervdj.be/hakyll/) for more information.</p>
<p>What I love most about Hakyll is how straightforward it is.
Essentially, all you need are some HTML templates, some CSS files, some
markdown files, and a set of rules that allow Pandoc to generate HTML
files from Markdown. Users are free to mix other Haskell libraries with
Hakyll to create their ideal website, without feeling limited by the
framework provided by the static site generator.</p>
<p>However, there were still two aspects that I found difficult to work
with. The first was my own unfamiliarity with the Haskell programming
language, which meant that I had to spend a lot of time researching how
to implement the features I wanted.</p>
<p>The other issue was that, compared to directly using the Pandoc
Library, I preferred to use the <a href="https://pandoc.org/#">Pandoc
command-line interface (CLI)</a>. Pandoc is already a complex software,
with a user manual of about 150 pages, and the functionality provided by
the CLI alone is already quite complex. If I were to use the library
instead, I would also have to deal with the complexity of Pandocâ€™s
internal implementation and the Haskell programming language. So, for
me, using only the CLI to convert formats is much simpler.</p>
<h1 data-number="2" id="babashka"><span class="header-section-number">2</span> Babashka</h1>
<p>In fact, several years ago when I began learning Clojure, I had the
idea that a powerful dynamic language like Clojure would be great as a
script language, capable of replacing Python or Bash for some quick
tasks. However, in practice, because Clojure is a dialect running on the
JVM, its startup speed is quite slow, making it not very suitable for
writing CLI tools.</p>
<p>Until recently, I discovered <a href="https://babashka.org">Babashka</a>, also known as â€œFast native
Clojure scripting runtimeâ€. From the introduction on the official
website, Babashka is designed to replace Bash scripts with a new
designed runtime. It uses GraalVM native image technology, which makes
its startup speed comparable to that of Python 3. When I found out about
Babashka, I thought that using it along with other Clojure libraries
would be a good way to quickly implement most of the functionality of
Hakyll.</p>
<p>My plan is to replace the HTML templates in Hakyll with <a href="https://github.com/weavejester/hiccup">Hicuup</a>. I will also use
the <a href="https://github.com/babashka/process">process library</a>
built into Babashka to call the Pandoc program. Additionally, I will use
Babashkaâ€™s <a href="https://book.babashka.org/#tasks">task runner</a> to
implement features such as <code>build</code> and
<code>serve</code>.</p>
<p>The whole process was much easier than I expected and very
interesting. Currently, I have removed the use of Hakyll completely from
the source code. Of course, I havenâ€™t fully implemented all of Hakyllâ€™s
features, but for now it meets my needs. Since I built it myself, I have
a better understanding of the entire website building process and have
more control over it than before.</p>
<h1 data-number="3" id="conclustion"><span class="header-section-number">3</span> Conclustion</h1>
<p>If you use a static site generator, you may find yourself creating
your own generator. Thatâ€™s what happened to me - I ended up building my
own
one.</p></div></div></section></article><comment><script async="async" crossorigin="anonymous" data-category="General" data-category-id="DIC_kwDOD5Bpa84COAIg" data-emit-metadata="0" data-input-position="top" data-lang="en" data-mapping="pathname" data-reactions-enabled="0" data-repo="onemouth/onemouth.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkyNjExMjI0MTE=" data-theme="light" src="https://giscus.app/client.js"></script><script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script></comment></div></main>
]]></summary></entry><entry><title>Consistent Hashing (å’Œå…¶ä»–é¡ä¼¼æ¼”ç®—æ³•)</title><link href="https://onemouth.github.io/posts/2023-01-02-consistent-hash.html" /><id>https://onemouth.github.io/posts/2023-01-02-consistent-hash.html</id><published>2023-01-02T12:00:00+08:00</published><updated>2023-01-02T12:00:00+08:00</updated><summary type="html"><![CDATA[<main><div><article><h1>Consistent
Hashing (å’Œå…¶ä»–é¡ä¼¼æ¼”ç®—æ³•)</h1><section class="header">
Posted on Jan 02, 2023
by LT
</section><section><div><div class="toc"><div class="header">Table of Contents</div><ul>
<li><a href="#å•é¡Œ1-å¹³å‡åˆ†é…" id="toc-å•é¡Œ1-å¹³å‡åˆ†é…"><span class="toc-section-number">1</span> å•é¡Œ1: å¹³å‡åˆ†é…</a>
<ul>
<li><a href="#æ–¹æ³•å–é¤˜æ•¸æ³•-mod-n" id="toc-æ–¹æ³•å–é¤˜æ•¸æ³•-mod-n"><span class="toc-section-number">1.1</span> æ–¹æ³•ï¼šå–é¤˜æ•¸æ³• (mod N)</a></li>
</ul></li>
<li><a href="#å•é¡Œ2-å‹•æ…‹å¢æ¸›æ©Ÿå™¨" id="toc-å•é¡Œ2-å‹•æ…‹å¢æ¸›æ©Ÿå™¨"><span class="toc-section-number">2</span> å•é¡Œ2: å‹•æ…‹å¢æ¸›æ©Ÿå™¨</a>
<ul>
<li><a href="#ring-based-consistent-hash" id="toc-ring-based-consistent-hash"><span class="toc-section-number">2.1</span> Ring-based Consistent
Hash</a></li>
<li><a href="#jump-consistent-hash" id="toc-jump-consistent-hash"><span class="toc-section-number">2.2</span> Jump Consistent Hash</a></li>
</ul></li>
<li><a href="#å•é¡Œ3hot-key-rebalance" id="toc-å•é¡Œ3hot-key-rebalance"><span class="toc-section-number">3</span> å•é¡Œ3ï¼šhot key (rebalance)</a>
<ul>
<li><a href="#etsy-casecache-smearing" id="toc-etsy-casecache-smearing"><span class="toc-section-number">3.1</span> Etsy caseï¼šcache smearing</a></li>
<li><a href="#redis-cluster-hash-slots" id="toc-redis-cluster-hash-slots"><span class="toc-section-number">3.2</span> Redis Cluster: Hash Slots</a></li>
<li><a href="#consistent-hashing-with-bounded-loads" id="toc-consistent-hashing-with-bounded-loads"><span class="toc-section-number">3.3</span> Consistent Hashing with Bounded
Loads</a></li>
</ul></li>
<li><a href="#çµèª" id="toc-çµèª"><span class="toc-section-number">4</span> çµèª</a></li>
</ul></div><div><p><em>ä¸»è¦å¾ä¹‹å‰åœ¨17
Liveçš„å…§éƒ¨åˆ†äº«éçš„æŠ•å½±ç‰‡æ•´ç†å‡ºå…§å®¹ã€‚</em></p>
<h1 data-number="1" id="å•é¡Œ1-å¹³å‡åˆ†é…"><span class="header-section-number">1</span> å•é¡Œ1: å¹³å‡åˆ†é…</h1>
<p>å‡è¨­æˆ‘å€‘æœ‰å·¨é‡çš„è³‡æ–™è¦è™•ç†ï¼Œä¸€å°æ©Ÿå™¨æ˜¯è™•ç†ä¸ä¾†çš„ï¼Œæ‰€ä»¥æˆ‘å€‘éœ€è¦å¾ˆå¤šå¾ˆå¤šå°æ©Ÿå™¨(Nå°)ä¾†è™•ç†ï¼Œé‚£æ¥ä¸‹ä¾†çš„å•é¡Œå°±æ˜¯ï¼Œè¦æ€éº¼æŠŠé€™äº›è³‡æ–™å¹³å‡åˆ†é…çµ¦é€™Nå°æ©Ÿå™¨ä¾†è™•ç†ï¼Ÿ</p>
<p>ç‚ºäº†å…·è±¡åŒ–é€™å€‹æƒ…å¢ƒ(ä½†ä¸å¤±ä¸€èˆ¬æ€§)ï¼Œä»¥ä¸‹éƒ½å‡è¨­æˆ‘å€‘ä½¿ç”¨äº†Nå° cache
server (<code>memcahed</code>)ï¼Œé€™äº›serverçš„ç·¨è™Ÿå¾0, 1, 2, â€¦ åˆ° N-1
ã€‚ç„¶å¾Œæ¯ç­†è³‡æ–™éƒ½æœ‰å…¶ç¨ä¸€ç„¡äºŒçš„<code>key</code>ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘å€‘éœ€è¦ä¸€å€‹å¥½çš„hash functionï¼Œé€™å€‹hash functionæœƒæŠŠ
<code>key</code> å¹³å‡å°æ‡‰åˆ° 0 åˆ° N-1 çš„æ­£æ•´æ•¸ã€‚</p>
<h2 data-number="1.1" id="æ–¹æ³•å–é¤˜æ•¸æ³•-mod-n"><span class="header-section-number">1.1</span> æ–¹æ³•ï¼šå–é¤˜æ•¸æ³• (mod N)</h2>
<p><code>Hash(key) mod N</code> ï¼Œé€™å€‹çµæœå¿…ç‚º 0 åˆ° N-1
çš„æ•¸ï¼Œä¹Ÿå°±æ±ºå®šäº†è¦è®“å“ªå°serverä¾†è™•ç†ã€‚</p>
<p>é€™å€‹æ–¹æ³•ç°¡å–®ç²—æš´ï¼Œç¼ºé»æ˜¯ mod N
çš„å¹³å‡åˆ†é…æ•ˆæœå–æ±ºæ–¼Næœ¬èº«çš„ä¸€äº›æ€§è³ª(æ˜¯å¦ç‚ºè³ªæ•¸ç­‰ç­‰)ï¼Œä½†åœ¨å¯¦å‹™ä¸Šæ‡‰è©²ä¹Ÿæ˜¯å ªç”¨äº†ã€‚</p>
<h1 data-number="2" id="å•é¡Œ2-å‹•æ…‹å¢æ¸›æ©Ÿå™¨"><span class="header-section-number">2</span> å•é¡Œ2: å‹•æ…‹å¢æ¸›æ©Ÿå™¨</h1>
<p>ç•¶è³‡æ–™é‡å¢åŠ çš„æ™‚å€™ï¼Œæˆ‘å€‘å¿…é ˆå¢åŠ è¶³å¤ çš„æ©Ÿå™¨å»è™•ç†ï¼Œç•¶è³‡æ–™é‡æ¸›å°‘çš„æ™‚å€™ï¼Œæˆ‘å€‘ç•¶ç„¶ä¹Ÿå¸Œæœ›æ¸›å°‘æ©Ÿå™¨ä»¥ç¯€çœæˆæœ¬ã€‚åœ¨æˆ‘å€‘cache
serverçš„æƒ…å¢ƒä¸­ï¼Œæˆ‘å€‘æœ€ä¸æƒ³çœ‹åˆ°çš„å°±æ˜¯ç•¶å¢æ¸›æ©Ÿå™¨çš„æ™‚å€™ï¼Œç”¢ç”Ÿå¤§é‡çš„cache
missï¼Œæ‰€ä»¥æˆ‘å€‘å®šç¾©ä»¥ä¸‹çš„éœ€æ±‚ï¼š</p>
<p>å°ä¸€å€‹Nå°æ©Ÿå™¨çš„clusterï¼Œå¢æ¸›ä¸€å°æ©Ÿå™¨çš„æ™‚å€™ï¼Œåªèƒ½å½±éŸ¿ç´„<code>1/N+1</code>çš„
cache key</p>
<p>èˆ‰ä¾‹ä¾†èªªï¼Œå‡å¦‚åŸå…ˆæœ‰4å°æ©Ÿå™¨ã€‚è€Œç¾åœ¨è¦è®Šæˆ5å°æ©Ÿå™¨ï¼Œé‚£æ–°çš„é‚£å°æ©Ÿå™¨ï¼Œè¦è² è²¬<code>1/5</code>çš„è³‡æ–™é‡ï¼Œè€Œä¸”é€™<code>1/5</code>è³‡æ–™é‡çš„ä¾†æºï¼Œè¦å¹³å‡çš„ä¾†è‡ªå…¶ä»–4å°æ©Ÿå™¨ã€‚</p>
<p>å–é¤˜æ•¸æ³•åœ¨é€™å€‹æƒ…å¢ƒæ˜¯ä¸é©ç”¨çš„ï¼Œå› ç‚ºç•¶serverçš„æ•¸é‡å¾Nè®Šåˆ°N+1ï¼Œå¹¾ä¹å¤§éƒ¨åˆ†cache
keyæ‰€å°æ‡‰åˆ°serveréƒ½æœƒæœ‰æ‰€æ”¹è®Šï¼Œç„¡æ³•é”åˆ°åªå½±éŸ¿1/Nçš„éœ€æ±‚ã€‚</p>
<p>ä¹Ÿå°±æ˜¯èªªï¼Œæˆ‘å€‘éœ€è¦ä¸€å€‹consistentçš„ hash
functionï¼Œç•¶Nè®ŠæˆN+1çš„æ™‚å€™ï¼Œå¤§éƒ¨åˆ†çš„ key
å°æ‡‰çš„ç·¨è™Ÿéƒ½æ˜¯ä¸è®Šçš„ï¼Œåªæ”¹è®Šäº†å…¶ä¸­ç´„ 1/N çš„keyçš„ç·¨è™Ÿã€‚</p>
<h2 data-number="2.1" id="ring-based-consistent-hash"><span class="header-section-number">2.1</span> Ring-based Consistent Hash</h2>
<h3 data-number="2.1.1" id="æ­·å²"><span class="header-section-number">2.1.1</span> æ­·å²</h3>
<p>Akamai å…¬å¸åœ¨1997å¹´çš„æ™‚å€™ï¼Œç™¼è¡¨äº†: <a href="https://www.akamai.com/site/en/documents/research-paper/consistent-hashing-and-random-trees-distributed-caching-protocols-for-relieving-hot-spots-on-the-world-wide-web-technical-publication.pdf">Consistent
Hashing and Random Trees: Distributed Caching Protocols for Relieving
Hot Spots on the World Wide Web</a>ã€‚</p>
<p>åˆ°äº†2007å¹´ï¼ŒAmazonçš„DynamoDBï¼Œåœ¨DB
partitioningçš„éƒ¨åˆ†ï¼Œæåˆ°ä»–å€‘ä½¿ç”¨äº†consistent hash
çš„æ¼”ç®—æ³•ï¼›è€Œåœ¨åŒå¹´ï¼Œlast.fm çš„å·¥ç¨‹å¸«ç™¼è¡¨äº†è‘—åçš„ <a href="https://github.com/RJ/ketama">Ketama</a> å¯¦ç¾ï¼Œä¹‹å¾Œ consistent
hash å°±è¢«å»£æ³›é‹ç”¨åˆ°web backendçš„å„å€‹é ˜åŸŸäº†ã€‚</p>
<h3 data-number="2.1.2" id="æ¦‚å¿µ"><span class="header-section-number">2.1.2</span> æ¦‚å¿µ</h3>
<p>Ring-basedçš„æƒ³æ³•é¦–å…ˆæ˜¯æŠŠHash function
çš„outputæƒ³æˆä¸€å€‹ç’°ï¼Œç„¶å¾Œæ¯å€‹serverè² è²¬é€™å€‹ç’°çš„ä¸€éƒ¨åˆ†(å®ˆå‚™ç¯„åœ)ï¼Œå¦‚åœ–æ‰€ç¤ºï¼š
<img src="../images/ring.png"> <img src="../images/ring_2.png">
å‡å¦‚æˆ‘å€‘éœ€è¦å¤šä¸€å°serverçš„è©±ï¼Œå› ç‚ºä¸æƒ³è¦å½±éŸ¿å¤ªå¤šåŸæœ‰çš„å®ˆå‚™ç¯„åœï¼Œå¯èƒ½æœƒæƒ³æŠŠé€™å€‹æ–°serveræ’åœ¨æŸå…©å€‹serverçš„ä¸­é–“ï¼Œä½†å‡å¦‚é€™å€‹åšçš„è©±ï¼Œæœƒå¾ˆæ˜é¡¯çš„çœ‹å‡ºserver
loadingä¸ä¸€è‡´çš„å•é¡Œã€‚ <img src="../images/ring_3.png"> <em>server5 å’Œ
server1 çš„ loadingæ˜¯å…¶ä»–serverçš„ä¸€åŠ</em></p>
<p>æ¥ä¸‹ä¾†ï¼Œæˆ‘å€‘å¼•é€²virtual node
çš„æ¦‚å¿µä¾†è§£æ±ºé€™å€‹å•é¡Œï¼Œæƒ³åƒæ¯å€‹serverå„è‡ªå°æ‡‰åˆ°nå€‹ç’°ä¸Šçš„virtual
nodeï¼Œé€™äº›virtual
nodeå¹³å‡çš„åˆ†ä½ˆåœ¨ç’°ä¸Šï¼Œç•¶æˆ‘å€‘æ–°å¢åˆªé™¤serverçš„æ™‚å€™ï¼Œå°±æ˜¯æŠŠä¸€å¤§ä¸²å°æ‡‰çš„virtual
nodeæ–°å¢åˆªé™¤è€Œå·²ï¼Œå› ç‚ºvirtual
nodeæ˜¯å¹³å‡åˆ†ä½ˆçš„ï¼Œæ‰€ä»¥å°loadingå½±éŸ¿ä¸å¤§ï¼Œä¹Ÿä¸æœƒè®“æ¯å€‹serverçš„å®ˆå‚™ç¯„åœæœ‰å¤§å¹…è®Šå‹•ã€‚</p>
<h3 data-number="2.1.3" id="å¯¦ç¾"><span class="header-section-number">2.1.3</span> å¯¦ç¾</h3>
<p>è©¦è‘—ç†è§£codeçš„è©±ï¼Œå¯ä»¥å°æ•´å€‹æ¼”ç®—æ³•æœ‰æ›´å¥½çš„æŒæ¡ã€‚</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode go"><code class="sourceCode go"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a><span class="kw">func</span> <span class="op">(</span>m <span class="op">*</span>Map<span class="op">)</span> Add<span class="op">(</span>nodes <span class="op">...</span><span class="dt">string</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a aria-hidden="true" href="#cb1-3" tabindex="-1"></a>    <span class="cf">for</span> _<span class="op">,</span> n <span class="op">:=</span> <span class="kw">range</span> nodes <span class="op">{</span></span>
<span id="cb1-4"><a aria-hidden="true" href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a aria-hidden="true" href="#cb1-5" tabindex="-1"></a>        <span class="cf">for</span> i <span class="op">:=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> m<span class="op">.</span>virtualNodes<span class="op">;</span> i<span class="op">++</span> <span class="op">{</span></span>
<span id="cb1-6"><a aria-hidden="true" href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a aria-hidden="true" href="#cb1-7" tabindex="-1"></a>            hash <span class="op">:=</span> <span class="dt">int</span><span class="op">(</span>m<span class="op">.</span>hash<span class="op">([]</span><span class="dt">byte</span><span class="op">(</span>strconv<span class="op">.</span>Itoa<span class="op">(</span>i<span class="op">)</span> <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> n<span class="op">)))</span></span>
<span id="cb1-8"><a aria-hidden="true" href="#cb1-8" tabindex="-1"></a>            m<span class="op">.</span>circle <span class="op">=</span> <span class="bu">append</span><span class="op">(</span>m<span class="op">.</span>circle<span class="op">,</span> hash<span class="op">)</span></span>
<span id="cb1-9"><a aria-hidden="true" href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a aria-hidden="true" href="#cb1-10" tabindex="-1"></a>            m<span class="op">.</span>hashMap<span class="op">[</span>hash<span class="op">]</span> <span class="op">=</span> n</span>
<span id="cb1-11"><a aria-hidden="true" href="#cb1-11" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-12"><a aria-hidden="true" href="#cb1-12" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-13"><a aria-hidden="true" href="#cb1-13" tabindex="-1"></a>    sort<span class="op">.</span>Ints<span class="op">(</span>m<span class="op">.</span>circle<span class="op">)</span></span>
<span id="cb1-14"><a aria-hidden="true" href="#cb1-14" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>ä¸ç®¡æ˜¯æ–°å¢æˆ–åˆªé™¤nodeï¼Œæˆ‘å€‘éƒ½æœƒé‡æ–°å‘¼å«é€™å€‹<code>Add</code>
functionï¼Œä¾†å»ºç«‹virtual nodeèˆ‡serverä¹‹é–“çš„å°æ‡‰ã€‚åœ¨é€™å€‹function
ä¸­æœ‰å…©å€‹é‡è¦çš„è®Šæ•¸ï¼š</p>
<ul>
<li><code>m.circle</code>: å¾å°åˆ°å¤§æ’åºå¥½çš„ virtual nodes</li>
<li><code>m.hashMap</code>: æ¯ä¸€å€‹virtual nodeå°æ‡‰åˆ°çš„server</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode go"><code class="sourceCode go"><span id="cb2-1"><a aria-hidden="true" href="#cb2-1" tabindex="-1"></a><span class="kw">func</span> <span class="op">(</span>m <span class="op">*</span>Map<span class="op">)</span> Get<span class="op">(</span>key <span class="dt">string</span><span class="op">)</span> <span class="dt">string</span> <span class="op">{</span></span>
<span id="cb2-2"><a aria-hidden="true" href="#cb2-2" tabindex="-1"></a>    hash <span class="op">:=</span> <span class="dt">int</span><span class="op">(</span>m<span class="op">.</span>hash<span class="op">([]</span><span class="dt">byte</span><span class="op">(</span>key<span class="op">)))</span></span>
<span id="cb2-3"><a aria-hidden="true" href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a aria-hidden="true" href="#cb2-4" tabindex="-1"></a>    idx <span class="op">:=</span> sort<span class="op">.</span>Search<span class="op">(</span><span class="bu">len</span><span class="op">(</span>m<span class="op">.</span>nodes<span class="op">),</span> </span>
<span id="cb2-5"><a aria-hidden="true" href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a aria-hidden="true" href="#cb2-6" tabindex="-1"></a>        <span class="kw">func</span><span class="op">(</span>i <span class="dt">int</span><span class="op">)</span> <span class="dt">bool</span> <span class="op">{</span> <span class="cf">return</span> m<span class="op">.</span>nodes<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;=</span> hash <span class="op">}</span></span>
<span id="cb2-7"><a aria-hidden="true" href="#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a aria-hidden="true" href="#cb2-8" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb2-9"><a aria-hidden="true" href="#cb2-9" tabindex="-1"></a>    <span class="cf">if</span> idx <span class="op">==</span> <span class="bu">len</span><span class="op">(</span>m<span class="op">.</span>nodes<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-10"><a aria-hidden="true" href="#cb2-10" tabindex="-1"></a>        idx <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-11"><a aria-hidden="true" href="#cb2-11" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-12"><a aria-hidden="true" href="#cb2-12" tabindex="-1"></a></span>
<span id="cb2-13"><a aria-hidden="true" href="#cb2-13" tabindex="-1"></a>    <span class="cf">return</span> m<span class="op">.</span>hashMap<span class="op">[</span>m<span class="op">.</span>nodes<span class="op">[</span>idx<span class="op">]]</span></span>
<span id="cb2-14"><a aria-hidden="true" href="#cb2-14" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>çµ¦å®šä¸€å€‹ keyï¼Œå¦‚ä½•æ‰¾åˆ°è¦è™•ç†é€™å€‹keyçš„Serverå‘¢ï¼Ÿåœ¨é€™å€‹<code>Get</code>
functionè£¡ï¼Œæˆ‘å€‘å¯ä»¥çœ‹åˆ°ï¼Œå°±æ˜¯åš<a href="https://pkg.go.dev/sort#Search">binary
search</a>ï¼Œæ‰¾åˆ°æœ€æ¥è¿‘çš„virtual
nodeï¼Œå†é€éhashMapåæŸ¥å›å¯¦é«”serverã€‚</p>
<p>ä»¥ä¸Šcodeä¾†è‡ªæ–¼<a href="https://github.com/serialx/hashring">https://github.com/serialx/hashring</a></p>
<h2 data-number="2.2" id="jump-consistent-hash"><span class="header-section-number">2.2</span> Jump Consistent Hash</h2>
<p>Googleåœ¨2014å¹´çš„æ™‚å€™ï¼Œæå‡ºäº†<a href="https://arxiv.org/ftp/arxiv/papers/1406/1406.2294.pdf">Jump
Consistent Hash</a>ï¼Œå·§å¦™çš„åˆ©ç”¨äº†<a href="https://en.wikipedia.org/wiki/Reservoir_sampling">æ°´å¡˜æŠ½æ¨£(Reservoir
sampling)</a>çš„æ¦‚å¿µï¼Œè¨­è¨ˆå‡ºäº†ä¸€å€‹ç›¸è¼ƒæ–¼Ring-basedï¼Œæ›´å¿«ï¼Œè¨˜æ†¶é«”ä½¿ç”¨é‡æ›´å°‘çš„Consistent
Hashã€‚</p>
<p>é¦–å…ˆæˆ‘å€‘å…ˆç”¨<a href="https://leetcode.com/problems/linked-list-random-node/description/">Leetcode
382: Linked List Random
Node</a>ï¼Œä¾†è§£é‡‹æ°´å¡˜æŠ½æ¨£çš„æ¦‚å¿µã€‚ç¾åœ¨æˆ‘å€‘æœ‰ä¸€å€‹æœªçŸ¥é•·åº¦çš„singly linked
listï¼Œéœ€è¦å¾é€™å€‹linked
listä¸­ï¼Œéš¨æ©Ÿçš„è¿”å›å…¶ä¸­ä¸€å€‹nodeçš„å€¼ï¼Œè€Œä¸”ï¼Œé¸æ“‡ä»»ä½•ä¸€å€‹nodeçš„æ©Ÿç‡éƒ½è¦æ˜¯ä¸€æ¨£çš„ã€‚æ­¤å¤–ï¼Œæˆ‘å€‘éœ€è¦é€™å€‹æ¼”ç®—æ³•æ˜¯1-passï¼Œä¸”space
complexity ç‚ºå¸¸æ•¸ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘å€‘å¯ä»¥åˆ©ç”¨éš¨æ©Ÿæ¼”ç®—æ³•çš„åŠ›é‡ï¼š</p>
<ol type="1">
<li>å…ˆå–node 1 çš„å€¼</li>
<li>æ¥ä¸‹ä¾†åˆ°node 2ï¼Œæˆ‘å€‘æœ‰1/2 çš„æ©Ÿç‡æ”¹å–node 2çš„å€¼ã€‚</li>
</ol>
<p>åˆ°é€™é‚Šå…ˆåœä¸€ä¸‹ï¼Œé€™å…©æ­¥åŸ·è¡Œå®Œä¹‹å¾Œï¼Œå¾ˆæ˜é¡¯æœ‰1/2çš„æ©Ÿç‡æ˜¯å–node
1ï¼Œ1/2çš„æ©Ÿç‡æ˜¯å–node 2ã€‚ç„¶å¾Œå†è€ƒæ…®node 3ï¼Œæˆ‘å€‘è¨­å®šæœ‰1/3çš„æ©Ÿç‡å–node
3çš„å€¼ï¼Œä¹Ÿå°±æ˜¯èªªï¼Œæœ‰2/3çš„æ©Ÿç‡æ˜¯å–åˆ°node 1æˆ–node 2ï¼Œç„¶å¾Œæˆ‘å€‘å–åˆ°node
1å’Œnode
2çš„æ©Ÿç‡åˆæ˜¯ç›¸ç­‰çš„ï¼Œæ–¼æ˜¯å°±è®Šæˆå‰3å€‹nodeçš„æ©Ÿç‡éƒ½æ˜¯1/3ã€‚ä»¥æ­¤é¡æ¨ï¼Œæˆ‘å€‘æœ‰1/4çš„æ©Ÿç‡æ›æˆnode
4ï¼Œæœ‰1/5çš„æ©Ÿç‡æ›æˆnode 5â€¦â€¦.æœ‰1/nçš„æ©Ÿç‡æ›æˆnode nã€‚</p>
<p>æ¯èµ°ä¸€æ­¥ï¼Œæœ‰ 1/n çš„æ©Ÿç‡æœƒæ”¹è®Šï¼Œå°æ¯”è·Ÿconsitent
hashingçš„è¦æ±‚ï¼šå°ä¸€å€‹Nå°æ©Ÿå™¨çš„clusterï¼Œå¢æ¸›ä¸€å°æ©Ÿå™¨çš„æ™‚å€™ï¼Œåªèƒ½å½±éŸ¿ç´„1/N+1çš„
cache keyï¼Œæ˜¯ä¸æ˜¯éå¸¸ç›¸ä¼¼ï¼Ÿï¼</p>
<p>æ‰€ä»¥ï¼Œæˆ‘å€‘å°±æœ‰äº†Jump Consistent Hash version 1ï¼š</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb3-1"><a aria-hidden="true" href="#cb3-1" tabindex="-1"></a><span class="dt">int</span> ch<span class="op">(</span><span class="dt">int</span> key<span class="op">,</span> <span class="dt">int</span> N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-2"><a aria-hidden="true" href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a aria-hidden="true" href="#cb3-3" tabindex="-1"></a>    random<span class="op">.</span>seed<span class="op">(</span>key<span class="op">);</span></span>
<span id="cb3-4"><a aria-hidden="true" href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a aria-hidden="true" href="#cb3-5" tabindex="-1"></a>    <span class="dt">int</span> b <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-6"><a aria-hidden="true" href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a aria-hidden="true" href="#cb3-7" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;</span> N<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb3-8"><a aria-hidden="true" href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a aria-hidden="true" href="#cb3-9" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>random<span class="op">.</span>next<span class="op">()</span> <span class="op">&lt;</span> <span class="fl">1.0</span> <span class="op">/</span> <span class="op">(</span>j <span class="op">+</span> <span class="dv">1</span><span class="op">))</span></span>
<span id="cb3-10"><a aria-hidden="true" href="#cb3-10" tabindex="-1"></a></span>
<span id="cb3-11"><a aria-hidden="true" href="#cb3-11" tabindex="-1"></a>            b <span class="op">=</span> j<span class="op">;</span></span>
<span id="cb3-12"><a aria-hidden="true" href="#cb3-12" tabindex="-1"></a></span>
<span id="cb3-13"><a aria-hidden="true" href="#cb3-13" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-14"><a aria-hidden="true" href="#cb3-14" tabindex="-1"></a></span>
<span id="cb3-15"><a aria-hidden="true" href="#cb3-15" tabindex="-1"></a>    <span class="cf">return</span> b<span class="op">;</span></span>
<span id="cb3-16"><a aria-hidden="true" href="#cb3-16" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>æŠŠ <code>key</code>åšç‚ºrandom
seedï¼Œæˆ‘å€‘å¯ä»¥å›ºå®šæ¯å€‹keyæœ€çµ‚æœƒè½åœ¨å“ªå€‹serverã€‚é€™å€‹version
1çš„æ™‚é–“è¤‡é›œåº¦æ˜¯O(N)ï¼Œ</p>
<p>åœ¨version
1ï¼Œæˆ‘å€‘è§€å¯Ÿåˆ°ä»¥ä¸‹æ©Ÿç‡çš„æ€§è³ªï¼šé¦–å…ˆï¼Œåœ¨é€™å€‹è¿´åœˆä¸­ï¼Œ<code>b</code>æ”¹è®Šçš„æ©Ÿç‡éš¨è‘—<code>j</code>è®Šå¤§ï¼Œå…¶å¯¦æ˜¯å¾ˆå°çš„:
(1/j+1)ã€‚</p>
<p>ä¹Ÿå°±æ˜¯å¯ä»¥å‡è¨­å¾ 1, 2, 3, â€¦, <em>b</em>, <em>b+1</em>, â€¦.,
<em>j</em>, j+1, â€¦. N-1 ä¸­ï¼Œå¾<em>b+1</em>, â€¦<em>j</em>
é€™æ®µéƒ½æ²’æ”¹è®Šå®ƒçš„å€¼ï¼Œéƒ½ç¶­æŒåœ¨<code>b</code>ã€‚é€™æ¨£çš„æ©Ÿç‡æ˜¯ (b+1)/j</p>
<p><span class="math display">\[ \frac{b+1}{b+2} \times \frac{b+2}{b+3}
\cdots \times \frac{j-1}{j} \]</span></p>
<p>æ‰€ä»¥ï¼Œè¨ˆç®—ä¸€æ¬¡éš¨æ©Ÿæ•¸rï¼Œå¾ r &lt;= (b+1) / j çš„ä¸ç­‰å¼ä¸­ï¼Œæ¨å‡º j &lt;=
floor(b+1/r)ï¼Œç„¶å¾Œä¾¿èƒ½å¯«å‡ºä»¥ä¸‹çš„codeï¼š</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb4-1"><a aria-hidden="true" href="#cb4-1" tabindex="-1"></a><span class="dt">int</span> ch<span class="op">(</span><span class="dt">int</span> key<span class="op">,</span> <span class="dt">int</span> num_buckets<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-2"><a aria-hidden="true" href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a aria-hidden="true" href="#cb4-3" tabindex="-1"></a>    random<span class="op">.</span>seed<span class="op">(</span>key<span class="op">);</span></span>
<span id="cb4-4"><a aria-hidden="true" href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a aria-hidden="true" href="#cb4-5" tabindex="-1"></a>    <span class="dt">int</span> b <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb4-6"><a aria-hidden="true" href="#cb4-6" tabindex="-1"></a>    <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-7"><a aria-hidden="true" href="#cb4-7" tabindex="-1"></a></span>
<span id="cb4-8"><a aria-hidden="true" href="#cb4-8" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>j <span class="op">&lt;</span> num_buckets<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-9"><a aria-hidden="true" href="#cb4-9" tabindex="-1"></a>        b <span class="op">=</span> j<span class="op">;</span></span>
<span id="cb4-10"><a aria-hidden="true" href="#cb4-10" tabindex="-1"></a>        <span class="dt">double</span> r <span class="op">=</span> random<span class="op">.</span>next<span class="op">();</span></span>
<span id="cb4-11"><a aria-hidden="true" href="#cb4-11" tabindex="-1"></a>        j <span class="op">=</span> floor<span class="op">((</span>b <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> r<span class="op">);</span></span>
<span id="cb4-12"><a aria-hidden="true" href="#cb4-12" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-13"><a aria-hidden="true" href="#cb4-13" tabindex="-1"></a></span>
<span id="cb4-14"><a aria-hidden="true" href="#cb4-14" tabindex="-1"></a>    <span class="cf">return</span> b<span class="op">;</span></span>
<span id="cb4-15"><a aria-hidden="true" href="#cb4-15" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>é€™å°±æ˜¯ jump consistent hashä¸­ï¼Œ<em>jump</em>
çš„ç”±ä¾†ï¼Œé€éè¨ˆç®—ä¸€æ¬¡éš¨æ©Ÿæ•¸ï¼Œå°±å¯ä»¥å¾€å‰ <em>jump</em>
ï¼Œæ¯”åŸä¾†çš„ä¸€æ­¥ä¸€æ­¥èµ°å¿«å¤šäº†ã€‚</p>
<p>åœ¨åŸè«–æ–‡ä¸­ï¼Œé‡å°å½éš¨æ©Ÿçš„éƒ¨åˆ†ï¼Œæå‡ºäº†æ›´é€²ä¸€æ­¥çš„å„ªåŒ–ï¼Œæ‰€ä»¥æœ‰äº†æœ€çµ‚ç‰ˆæœ¬ï¼š</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb5-1"><a aria-hidden="true" href="#cb5-1" tabindex="-1"></a><span class="dt">int32_t</span> JumpConsistentHash<span class="op">(</span><span class="dt">uint64_t</span> key<span class="op">,</span> <span class="dt">int32_t</span> num_buckets <span class="op">{</span></span>
<span id="cb5-2"><a aria-hidden="true" href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a aria-hidden="true" href="#cb5-3" tabindex="-1"></a>    <span class="dt">int64_t</span> b <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb5-4"><a aria-hidden="true" href="#cb5-4" tabindex="-1"></a>    <span class="dt">int64_t</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-5"><a aria-hidden="true" href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a aria-hidden="true" href="#cb5-6" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>j <span class="op">&lt;</span> num_buckets<span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-7"><a aria-hidden="true" href="#cb5-7" tabindex="-1"></a>        b <span class="op">=</span> j<span class="op">;</span></span>
<span id="cb5-8"><a aria-hidden="true" href="#cb5-8" tabindex="-1"></a>        key <span class="op">=</span> key <span class="op">*</span> <span class="dv">2862933555777941757</span><span class="bu">ULL</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb5-9"><a aria-hidden="true" href="#cb5-9" tabindex="-1"></a>        j <span class="op">=</span> <span class="op">(</span>b <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="dt">double</span><span class="op">(</span><span class="dv">1</span><span class="bu">LL</span> <span class="op">&lt;&lt;</span> <span class="dv">31</span><span class="op">)</span> <span class="op">/</span> <span class="dt">double</span><span class="op">((</span>key <span class="op">&gt;&gt;</span> <span class="dv">33</span><span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">));</span></span>
<span id="cb5-10"><a aria-hidden="true" href="#cb5-10" tabindex="-1"></a></span>
<span id="cb5-11"><a aria-hidden="true" href="#cb5-11" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-12"><a aria-hidden="true" href="#cb5-12" tabindex="-1"></a></span>
<span id="cb5-13"><a aria-hidden="true" href="#cb5-13" tabindex="-1"></a>    <span class="cf">return</span> b<span class="op">;</span></span>
<span id="cb5-14"><a aria-hidden="true" href="#cb5-14" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 data-number="2.2.1" id="ç¼ºé»"><span class="header-section-number">2.2.1</span> ç¼ºé»</h3>
<p>Jump Consistent Hash
æœ‰è‘—ç°¡æ½”çš„å¯¦ç¾ï¼Œå¾æ©Ÿç‡ä¸Šä¹Ÿå¾—åˆ°æ›´å¥½çš„å‡å‹»åˆ†å¸ƒï¼Œä½†åœ¨å¯¦å‹™ä¸Šï¼Œå®ƒé‚„æ˜¯æœ‰è‘—ä¸€äº›ç¼ºé»ï¼šé¦–å…ˆï¼Œå¿…é ˆä¿å­˜ä¸€å€‹
server name å° index çš„å°æ‡‰ï¼Œå› ç‚ºåœ¨consistent
hashä¸­ï¼Œserverä¸€å¾‹æ˜¯ç”¨numberä¾†è¡¨ç¤ºçš„ã€‚</p>
<p>æ¥ä¸‹ä¾†è¦å¾ä¸­é–“ç§»é™¤ä¸€å€‹serveræ˜¯ä¸å¯è¡Œçš„ï¼Œå› ç‚ºé€™æ¨£æœƒè®“ç·¨è™Ÿä¸­é–“ç©ºå‡ºä¸€å€‹ï¼Œæˆ‘å€‘å°ä¸­é–“çš„nodeåªèƒ½åšreplaceï¼Œè€Œæ–°å¢åˆªé™¤nodeåªèƒ½å¾å°¾ç«¯(tail)åšèµ·ã€‚ç›¸å°ä¾†èªªï¼ŒRing-based
Consistent Hash åªæ˜¯å»ç§»é™¤å°æ‡‰çš„ virtual nodesï¼Œå°±å½ˆæ€§äº†è¨±å¤šã€‚</p>
<p>å¾é€™é»è€ƒæ…®ï¼ŒJump Consistent Hash æ¯”è¼ƒé©åˆnode
ä¸æœƒåŠ‡çƒˆæ”¹è®Šçš„ç’°å¢ƒï¼Œä¾‹å¦‚database storageã€‚</p>
<h1 data-number="3" id="å•é¡Œ3hot-key-rebalance"><span class="header-section-number">3</span> å•é¡Œ3ï¼šhot key (rebalance)</h1>
<p>åœ¨ä¹‹å‰çš„æ•…äº‹ä¸­ï¼Œæˆ‘å€‘æˆåŠŸçš„æŠŠkeyä¸€è¦–åŒä»çš„åˆ†æ•£åˆ°æ¯å€‹æ©Ÿå™¨å»è™•ç†äº†ï¼Œå¯æƒœçš„æ˜¯ï¼Œåœ¨çœŸå¯¦ä¸–ç•Œä¸­ï¼Œæœ‰äº›keyå°±æ˜¯æ¯”å…¶ä»–çš„keyç†±é–€ï¼Œé€™äº›hot
keyçš„å­˜åœ¨ï¼Œæœƒè®“éƒ¨åˆ†cache
serverçš„loadingé é«˜æ–¼å…¶ä»–serverï¼Œå› æ­¤ï¼Œæˆ‘å€‘å¿…é ˆåšé©ç•¶çš„rebalanceï¼Œå†æ¬¡åˆ†æ•£å­˜åœ¨hot
keyçš„serverçš„loadingã€‚</p>
<h2 data-number="3.1" id="etsy-casecache-smearing"><span class="header-section-number">3.1</span> Etsy caseï¼šcache smearing</h2>
<p>Etsy åœ¨é€™ç¯‡<a href="https://www.etsy.com/codeascraft/how-etsy-caches">How Etsy caches:
hashing, Ketama, and cache smearing</a>ä¸­ï¼Œè§£é‡‹äº†ä»–å€‘å¦‚ä½•è™•ç†åœ¨
memcached cluster é‡åˆ°çš„ hot key å•é¡Œã€‚</p>
<p>Etsyä½¿ç”¨äº†consistent hashï¼Œå°‡è¦åšhttp cacheçš„è³‡æ–™åˆ†æ•£çµ¦ä¸åŒmemcached
serverå»è™•ç†ï¼Œå¯ä»¥æƒ³è¦‹çš„æ˜¯ï¼Œæœ‰äº›httpé é¢å°±æ˜¯æ¯”å…¶ä»–é é¢é‚„è¦ç†±é–€è¨±å¤šï¼Œæ‰€ä»¥ç”¢ç”Ÿäº†hot
key å•é¡Œã€‚</p>
<p>å°æ–¼hot keyå•é¡Œï¼ŒEtsyä½¿ç”¨äº†ä¸€ç¨®ä»–å€‘ç¨±ç‚ºcache
smearingçš„æŠ€å·§ï¼Œé€™å€‹æŠ€å·§æ˜¯é€™æ¨£çš„ï¼šå‡å¦‚ç¾åœ¨æˆ‘å€‘å·²ç¶“çŸ¥é“æœ‰ä¸€å€‹hot
keyç‚º<code>popular_key</code>ï¼Œæˆ‘å€‘å°±æŠŠé€™å€‹key
duplicateå¹¾ä»½ï¼š<code>popular_key_1, popular_key_2, popular_key_3... popular_key_16&nbsp;</code>ï¼Œé€™äº›keyå…¨éƒ¨å°æ‡‰åˆ°ç›¸åŒçš„å…§å®¹ï¼Œä¹Ÿå°±æ˜¯å°‡1å€‹hot
keyè®Šæˆå¤šå€‹keyï¼Œè™•ç†hot keyå…§å®¹çš„serverè®Šå¤šäº†ï¼Œä¹Ÿå°±æ¸›ç·©äº†hot
keyå¸¶ä¾†çš„å½±éŸ¿ã€‚</p>
<p>åœ¨å¯¦å‹™ä¸Šï¼ŒEtsyä½¿ç”¨mctopå»ç›£æ§memcached clusterï¼Œä¸¦å°‡è§€æ¸¬åˆ°çš„hot
keyæ‰‹å‹•åŠ å…¥åˆ°ä¸€å€‹cache smearingæ¸…å–®è£¡ã€‚</p>
<h2 data-number="3.2" id="redis-cluster-hash-slots"><span class="header-section-number">3.2</span> Redis Cluster: Hash Slots</h2>
<p>åœ¨Redis Cluster çš„æ¶æ§‹ä¸­ï¼ŒRedis
æå‡ºäº†ä¸€ç¨®æ›´åŠ å½ˆæ€§çš„ä½œæ³•(ä½†ä¹Ÿéœ€è¦æ›´å¤šçš„äººç‚ºæ“ä½œ)ã€‚</p>
<p>é¦–å…ˆï¼ŒRedisåˆ©ç”¨CRCæ¼”ç®—æ³•ï¼ŒåŠƒåˆ†å‡ºäº†16384å€‹<strong>slots</strong>ï¼Œä¹Ÿå°±æ˜¯èªªï¼Œæ¯ä¸€å€‹cache_keyç¶“éCRCæ¼”ç®—æ³•å¾Œï¼Œå°±å¯ä»¥çŸ¥é“è¦ç”±å“ªä¸€å€‹slotè² è²¬è™•ç†ã€‚é‡é»æ˜¯é€™äº›slotsæ˜¯è™›æ“¬çš„ï¼Œä½¿ç”¨è€…å¯ä»¥é€²ä¸€æ­¥æ§åˆ¶å“ªäº›slotsè¦ç”±å“ªäº›å¯¦é«”æ©Ÿå™¨ä¾†è™•ç†ï¼Œ</p>
<p>ä¹Ÿå°±æ˜¯èªªï¼Œç•¶æˆ‘å€‘è§€æ¸¬åˆ°hot
keyå•é¡Œçš„æ™‚å€™ï¼Œæ˜¯å¯ä»¥è—‰ç”±æ‰‹å‹•é‡æ–°åˆ†é…slotsåˆ°ä¸åŒçš„æ©Ÿå™¨ä¸Šä¾†è§£æ±ºçš„ã€‚</p>
<h2 data-number="3.3" id="consistent-hashing-with-bounded-loads"><span class="header-section-number">3.3</span> Consistent Hashing with Bounded
Loads</h2>
<p>å°æ–¼ hot key å•é¡Œï¼ŒGoogle æå‡ºäº†å¦å¤–ä¸€ç¨®ä½œæ³•ï¼š<a href="https://ai.googleblog.com/2017/04/consistent-hashing-with-bounded-loads.html">Consistent
Hashing with Bounded Loads</a>ã€‚</p>
<p>é€™å€‹ä½œæ³•æ˜¯åŸºæ–¼ring-based consistent
hashï¼šé¦–å…ˆæˆ‘å€‘ç›£æ§æ¯å°serverçš„loadingï¼Œä¸¦è¨­ç½®æ¯å°serverçš„loadingä¸Šé™ï¼Œç¾åœ¨å‡è¨­é€™å€‹ä¸Šé™æ˜¯125%ï¼Œç•¶æœ‰ä¸€å°server
Aä»–çš„loadingè¶…éæ¯å°serverå¹³å‡çš„loadingç™¾åˆ†ä¹‹25çš„æ™‚å€™ï¼Œå°±æœƒå•Ÿå‹•bounded
loadsçš„æ©Ÿåˆ¶ã€‚</p>
<p>é€™å€‹æ©Ÿåˆ¶å°±æ˜¯ï¼Œæ¥ä¸‹ä¾†åŸæœ¬è¦çµ¦Aè™•ç†çš„keyï¼Œæœƒè½‰çµ¦æ²¿è‘—ringé †æ™‚é˜æ–¹å‘ï¼Œä¸‹ä¸€å€‹virtual
nodeå°æ‡‰çš„å¯¦é«”serverä¾†è™•ç†ï¼Œè—‰æ­¤ä¾†åˆ†æ•£loadingã€‚</p>
<p>é€²ä¸€æ­¥åˆ†æé€™å€‹æ¼”ç®—æ³•ï¼Œå¯ä»¥å¾—åˆ°ä¸‹é¢ä¸‰å€‹å¥½è™•ï¼š</p>
<ol type="1">
<li>æ²’æœ‰ä»»ä½•serverè¶…éloadingçš„è©±ï¼Œå°±æ˜¯ä¸€èˆ¬çš„ring-based consistent
hashingã€‚</li>
<li>å°ç›¸åŒkeyä¾†èªªï¼Œå®ƒçš„fallback serveræ˜¯ä¸€è‡´çš„ã€‚</li>
<li>å°ä¸åŒkeyä¾†èªªï¼Œå®ƒçš„fallback serveræ˜¯ä¸ä¸€æ¨£çš„ã€‚</li>
</ol>
<p>Vimeo æŠŠé€™å€‹æ¼”ç®—æ³•å¯¦ä½œåœ¨ HAProxy ä¸Šï¼Œä½œç‚ºå…¶load
balanceræ©Ÿåˆ¶çš„å…¶ä¸­ä¸€å€‹é¸é …ã€‚æ ¹æ“šVimeoçš„<a href="https://medium.com/vimeo-engineering-blog/improving-load-balancing-with-a-new-consistent-hashing-algorithm-9f1bd75709ed">æ¸¬è©¦</a>ï¼Œloadingä¸Šé™è¨­ç½®åœ¨125%ï½200%ä¸­ï¼Œéƒ½æœ‰ä¸éŒ¯çš„æ•ˆæœã€‚</p>
<h1 data-number="4" id="çµèª"><span class="header-section-number">4</span> çµèª</h1>
<p>é€™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç´¹äº† consitent hash
çš„æ¦‚å¿µï¼Œä»¥åŠç›¸é—œçš„æ¼”ç®—æ³•ï¼Œå¦‚ä»¥ä¸‹ï¼š</p>
<ul>
<li>ring-based consitent hashing</li>
<li>jump consistent hashing</li>
<li>redis hash slots</li>
<li>consistent hash with bounded loads</li>
</ul></div></div></section></article><comment><script async="async" crossorigin="anonymous" data-category="General" data-category-id="DIC_kwDOD5Bpa84COAIg" data-emit-metadata="0" data-input-position="top" data-lang="en" data-mapping="pathname" data-reactions-enabled="0" data-repo="onemouth/onemouth.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkyNjExMjI0MTE=" data-theme="light" src="https://giscus.app/client.js"></script><script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script></comment></div></main>
]]></summary></entry><entry><title>è¨­è¨ˆ Golang çš„ error</title><link href="https://onemouth.github.io/posts/2022-09-20-golang-errors.html" /><id>https://onemouth.github.io/posts/2022-09-20-golang-errors.html</id><published>2022-09-20T12:00:00+08:00</published><updated>2022-09-20T12:00:00+08:00</updated><summary type="html"><![CDATA[<main><div><article><h1>è¨­è¨ˆ
Golang çš„ error</h1><section class="header">
Posted on Sep 20, 2022
by LT
</section><section><div><div class="toc"><div class="header">Table of Contents</div><ul>
<li><a href="#package-å…§éƒ¨ç”¢ç”Ÿçš„-error" id="toc-package-å…§éƒ¨ç”¢ç”Ÿçš„-error"><span class="toc-section-number">1</span> package å…§éƒ¨ç”¢ç”Ÿçš„ error</a>
<ul>
<li><a href="#sentinel-error" id="toc-sentinel-error"><span class="toc-section-number">1.1</span> Sentinel Error</a></li>
<li><a href="#å®šç¾©ä¸€å€‹-error-type" id="toc-å®šç¾©ä¸€å€‹-error-type"><span class="toc-section-number">1.2</span> å®šç¾©ä¸€å€‹ error type</a></li>
</ul></li>
<li><a href="#éœ€è¦åŒ…è£wrapå…¶ä»–error" id="toc-éœ€è¦åŒ…è£wrapå…¶ä»–error"><span class="toc-section-number">2</span>
éœ€è¦åŒ…è£(Wrap)å…¶ä»–error</a>
<ul>
<li><a href="#å®šç¾©ä¸€å€‹-struct" id="toc-å®šç¾©ä¸€å€‹-struct"><span class="toc-section-number">2.1</span> å®šç¾©ä¸€å€‹ struct</a></li>
</ul></li>
<li><a href="#çµèª" id="toc-çµèª"><span class="toc-section-number">3</span> çµèª</a></li>
</ul></div><div><p>åœ¨ Go è£¡é¢ï¼Œä¸»è¦ç”¨ä¾†è™•ç† error çš„æ–¹æ³•ï¼Œæ˜¯åˆ©ç”¨åœ¨ Go
1.13 æ™‚æ–°å¼•å…¥çš„é€™å…©å€‹å‡½å¼ï¼š<a href="https://pkg.go.dev/errors#Is">errors.Is</a> å’Œ <a href="https://pkg.go.dev/errors#As">errors.As</a>ã€‚åœ¨æœ¬æ–‡ï¼Œæƒ³è¦æ¢è¨å¦‚ä½•è¨­è¨ˆå¥½çš„error
typeï¼Œæ‰èƒ½å’Œ Go æ¨™æº–åº«æä¾›çš„é€™å…©å€‹å‡½æ•¸é…åˆçš„å¤©è¡£ç„¡ç¸«ã€‚</p>
<p>é¦–å…ˆå…ˆæŠŠerrorå¤§ç•¥åˆ†çˆ²å…©ç¨®ï¼Œä¸€ç¨®æ˜¯æ²’æœ‰åŒ…è£å…¶ä»–errorçš„ï¼Œæ˜¯æˆ‘å€‘çš„é€™å€‹packageå…§éƒ¨ç”¢ç”Ÿçš„errorï¼Œå’Œå…¶ä»–packageç„¡é—œã€‚å¦ä¸€ç¨®å‰‡æ˜¯æœ‰åŒ…è£çš„ï¼Œæ˜¯åœ¨æˆ‘å€‘å‘¼å«å…¶ä»–packageçš„æ™‚å€™ç”¢ç”Ÿçš„errorï¼Œå› æ­¤å¿…é ˆä¿ç•™é€™å€‹ä¸Šä¸‹æ–‡ã€‚</p>
<p>ä»¥ä¸‹ä¾†åˆ†åˆ¥çœ‹ä¸€ä¸‹å…©ç¨®errorçš„è¨­è¨ˆã€‚</p>
<h1 data-number="1" id="package-å…§éƒ¨ç”¢ç”Ÿçš„-error"><span class="header-section-number">1</span> package å…§éƒ¨ç”¢ç”Ÿçš„ error</h1>
<h2 data-number="1.1" id="sentinel-error"><span class="header-section-number">1.1</span> Sentinel Error</h2>
<p>é€™æ˜¯æœ€å¸¸è¦‹çš„ï¼Œä¹Ÿåœ¨è¨±å¤šçŸ¥åçš„packageè¢«å»£æ³›ä½¿ç”¨ã€‚</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode go"><code class="sourceCode go"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a><span class="kw">package</span> example</span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a aria-hidden="true" href="#cb1-3" tabindex="-1"></a><span class="kw">var</span> <span class="op">(</span></span>
<span id="cb1-4"><a aria-hidden="true" href="#cb1-4" tabindex="-1"></a>  ErrExample <span class="op">=</span> erros<span class="op">.</span>New<span class="op">(</span><span class="st">"test"</span><span class="op">)</span></span>
<span id="cb1-5"><a aria-hidden="true" href="#cb1-5" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb1-6"><a aria-hidden="true" href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a aria-hidden="true" href="#cb1-7" tabindex="-1"></a><span class="co">// Error Handling</span></span>
<span id="cb1-8"><a aria-hidden="true" href="#cb1-8" tabindex="-1"></a>err <span class="op">:=</span> example<span class="op">.</span>DoSomething<span class="op">()</span></span>
<span id="cb1-9"><a aria-hidden="true" href="#cb1-9" tabindex="-1"></a><span class="cf">if</span> errors<span class="op">.</span>Is<span class="op">(</span>err<span class="op">,</span> example<span class="op">.</span>ErrExmaple<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-10"><a aria-hidden="true" href="#cb1-10" tabindex="-1"></a>    fmt<span class="op">.</span>Println<span class="op">(</span><span class="st">"do error handling)</span></span>
<span id="cb1-11"><a aria-hidden="true" href="#cb1-11" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>sentinal
errorçš„å¥½è™•æ˜¯ç°¡å–®ï¼Œå®šç¾©å¿«é€Ÿï¼Œåˆä¸€ç›®ç­ç„¶ã€‚ç¼ºé»æ˜¯å®šç¾©äº†å…¨åŸŸè®Šæ•¸ï¼Œé‚„æœ‰åœ¨runtimeæ‰åˆå§‹åŒ–ã€‚ä½†é€™ç¨®å½¢å¼æ˜¯å¦‚æ­¤çš„å¸¸è¦‹ï¼Œæˆ‘æƒ³é€™äº›ç¼ºé»ä¸æ˜¯å¤§å•é¡Œæ‰æ˜¯ã€‚</p>
<h2 data-number="1.2" id="å®šç¾©ä¸€å€‹-error-type"><span class="header-section-number">1.2</span> å®šç¾©ä¸€å€‹ error type</h2>
<p>å¦ä¸€ç¨®å¸¸è¦‹çš„æ–¹æ³•æ˜¯å®šç¾©ä¸€å€‹ error typeï¼Œé€™å€‹type æœƒå¯¦ä½œ
<code>Error() string</code>ã€‚æˆ‘å€‘å†åˆ©ç”¨é€™å€‹ typeï¼Œå®šç¾©ä¸€äº› const
errorã€‚</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode go"><code class="sourceCode go"><span id="cb2-1"><a aria-hidden="true" href="#cb2-1" tabindex="-1"></a><span class="kw">type</span> InvalidFormatError <span class="dt">string</span></span>
<span id="cb2-2"><a aria-hidden="true" href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a aria-hidden="true" href="#cb2-3" tabindex="-1"></a><span class="kw">func</span> <span class="op">(</span>e InvalidFormatError<span class="op">)</span> Error<span class="op">()</span> <span class="dt">string</span> <span class="op">{</span></span>
<span id="cb2-4"><a aria-hidden="true" href="#cb2-4" tabindex="-1"></a>    <span class="cf">return</span> <span class="dt">string</span><span class="op">(</span>e<span class="op">)</span></span>
<span id="cb2-5"><a aria-hidden="true" href="#cb2-5" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-6"><a aria-hidden="true" href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a aria-hidden="true" href="#cb2-7" tabindex="-1"></a><span class="kw">const</span> <span class="op">(</span></span>
<span id="cb2-8"><a aria-hidden="true" href="#cb2-8" tabindex="-1"></a>    ErrNoDdata         <span class="op">=</span> InvalidFormatError<span class="op">(</span><span class="st">"no data"</span><span class="op">)</span></span>
<span id="cb2-9"><a aria-hidden="true" href="#cb2-9" tabindex="-1"></a>    ErrLengthTooLong   <span class="op">=</span> InvalidFormatError<span class="op">(</span><span class="st">"length too long"</span><span class="op">)</span></span>
<span id="cb2-10"><a aria-hidden="true" href="#cb2-10" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb2-11"><a aria-hidden="true" href="#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a aria-hidden="true" href="#cb2-12" tabindex="-1"></a></span>
<span id="cb2-13"><a aria-hidden="true" href="#cb2-13" tabindex="-1"></a><span class="co">// Error Handling</span></span>
<span id="cb2-14"><a aria-hidden="true" href="#cb2-14" tabindex="-1"></a><span class="cf">if</span> errors<span class="op">.</span>Is<span class="op">(</span>err<span class="op">,</span> ErrLengthTooLong<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-15"><a aria-hidden="true" href="#cb2-15" tabindex="-1"></a>    fmt<span class="op">.</span>Println<span class="op">(</span><span class="st">"do error handling"</span><span class="op">)</span> </span>
<span id="cb2-16"><a aria-hidden="true" href="#cb2-16" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-17"><a aria-hidden="true" href="#cb2-17" tabindex="-1"></a></span>
<span id="cb2-18"><a aria-hidden="true" href="#cb2-18" tabindex="-1"></a><span class="kw">var</span> badRequest InvalidFormatError</span>
<span id="cb2-19"><a aria-hidden="true" href="#cb2-19" tabindex="-1"></a><span class="cf">if</span> errors<span class="op">.</span>As<span class="op">(</span>err<span class="op">,</span> <span class="op">&amp;</span>badRequest<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-20"><a aria-hidden="true" href="#cb2-20" tabindex="-1"></a>    fmt<span class="op">.</span>Println<span class="op">(</span><span class="st">"do error handling"</span><span class="op">)</span></span>
<span id="cb2-21"><a aria-hidden="true" href="#cb2-21" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>é€™ç¨®å¯«æ³•çš„å¥½è™•é™¤äº†ä¹Ÿæ”¯æ´ <code>errros.Is</code> ä»¥å¤–ï¼Œæˆ‘å€‘é‚„å¯ä»¥åˆ©ç”¨
<code>errors.As</code> å»åˆ¤æ–·åŒä¸€é¡çš„ errorã€‚</p>
<p>ä¾‹å¦‚åœ¨é€™å€‹ä¾‹å­ï¼ŒErrNoData å’Œ ErrLengthTooLong éƒ½å±¬æ–¼
InvalidFormatError é€™å€‹typeï¼Œæ‰€ä»¥å‡å¦‚åªæƒ³çŸ¥é“é€™å€‹ error å±¬æ–¼
InvalidFormatError é€™ä¸€é¡çš„è©±ï¼Œå°±å¯ä»¥åˆ©ç”¨ errros.As ä¾†åšåˆ¤æ–·ã€‚</p>
<p>å…¶ä»–å¥½è™•åŒ…æ‹¬äº†ä¸ç”¨å®šç¾©å…¨åŸŸè®Šæ•¸ï¼Œä¸ç”¨åœ¨runtimeåˆå§‹åŒ–ã€‚ç¼ºé»å‰‡æ˜¯å¯«æ³•æ¯”è¼ƒè¤‡é›œã€‚</p>
<h1 data-number="2" id="éœ€è¦åŒ…è£wrapå…¶ä»–error"><span class="header-section-number">2</span> éœ€è¦åŒ…è£(Wrap)å…¶ä»–error</h1>
<p>åœ¨å…¶ä»–æƒ…æ³ï¼Œæˆ‘å€‘çš„erroréœ€è¦åŒ…è£å…¶ä»–packageçš„errorã€‚æœ€ç°¡å–®çš„æ–¹æ³•æ˜¯åˆ©ç”¨
<code>fmt.Errorf("%w", err)</code> ç›´æ¥åŒ…è£ã€‚ä½†æˆ‘å€‘ä¹Ÿå¯ä»¥åˆ©ç”¨å®šç¾© struct
çš„æ–¹æ³•ï¼Œè®“errorçš„æ¶æ§‹è®Šå¾—æ›´æ¸…æ™°ã€‚</p>
<h2 data-number="2.1" id="å®šç¾©ä¸€å€‹-struct"><span class="header-section-number">2.1</span> å®šç¾©ä¸€å€‹ struct</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode go"><code class="sourceCode go"><span id="cb3-1"><a aria-hidden="true" href="#cb3-1" tabindex="-1"></a><span class="kw">type</span> myDBPkgError <span class="kw">struct</span> <span class="op">{</span></span>
<span id="cb3-2"><a aria-hidden="true" href="#cb3-2" tabindex="-1"></a>    value <span class="dt">string</span></span>
<span id="cb3-3"><a aria-hidden="true" href="#cb3-3" tabindex="-1"></a>    err   <span class="dt">error</span></span>
<span id="cb3-4"><a aria-hidden="true" href="#cb3-4" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-5"><a aria-hidden="true" href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a aria-hidden="true" href="#cb3-6" tabindex="-1"></a><span class="kw">func</span> <span class="op">(</span>bv <span class="op">*</span>myDBPkgError<span class="op">)</span> Error<span class="op">()</span> <span class="dt">string</span> <span class="op">{</span></span>
<span id="cb3-7"><a aria-hidden="true" href="#cb3-7" tabindex="-1"></a>    <span class="cf">return</span> fmt<span class="op">.</span>Sprintf<span class="op">(</span><span class="st">"bad value %v"</span><span class="op">,</span> bv<span class="op">.</span>value<span class="op">)</span></span>
<span id="cb3-8"><a aria-hidden="true" href="#cb3-8" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-9"><a aria-hidden="true" href="#cb3-9" tabindex="-1"></a></span>
<span id="cb3-10"><a aria-hidden="true" href="#cb3-10" tabindex="-1"></a><span class="kw">func</span> <span class="op">(</span>bv <span class="op">*</span>myDBPkgError<span class="op">)</span> Unwrap<span class="op">()</span> <span class="dt">error</span> <span class="op">{</span></span>
<span id="cb3-11"><a aria-hidden="true" href="#cb3-11" tabindex="-1"></a>    <span class="cf">return</span> bv<span class="op">.</span>err</span>
<span id="cb3-12"><a aria-hidden="true" href="#cb3-12" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-13"><a aria-hidden="true" href="#cb3-13" tabindex="-1"></a></span>
<span id="cb3-14"><a aria-hidden="true" href="#cb3-14" tabindex="-1"></a><span class="kw">func</span> <span class="op">(</span>bv <span class="op">*</span>myDBPkgError<span class="op">)</span> Is<span class="op">(</span>target <span class="dt">error</span><span class="op">)</span> <span class="dt">bool</span> <span class="op">{</span></span>
<span id="cb3-15"><a aria-hidden="true" href="#cb3-15" tabindex="-1"></a>    <span class="cf">if</span> target <span class="op">==</span> sql<span class="op">.</span>ErrNoRows <span class="op">{</span></span>
<span id="cb3-16"><a aria-hidden="true" href="#cb3-16" tabindex="-1"></a>        <span class="cf">return</span> <span class="ot">true</span></span>
<span id="cb3-17"><a aria-hidden="true" href="#cb3-17" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-18"><a aria-hidden="true" href="#cb3-18" tabindex="-1"></a>    <span class="cf">return</span> <span class="ot">false</span></span>
<span id="cb3-19"><a aria-hidden="true" href="#cb3-19" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-20"><a aria-hidden="true" href="#cb3-20" tabindex="-1"></a></span>
<span id="cb3-21"><a aria-hidden="true" href="#cb3-21" tabindex="-1"></a><span class="kw">func</span> testErr<span class="op">()</span> <span class="dt">error</span> <span class="op">{</span></span>
<span id="cb3-22"><a aria-hidden="true" href="#cb3-22" tabindex="-1"></a>    v <span class="op">:=</span> <span class="dv">3</span></span>
<span id="cb3-23"><a aria-hidden="true" href="#cb3-23" tabindex="-1"></a>    err <span class="op">:=</span> processDB<span class="op">(</span>v<span class="op">)</span></span>
<span id="cb3-24"><a aria-hidden="true" href="#cb3-24" tabindex="-1"></a>    <span class="cf">if</span> err <span class="op">!=</span> <span class="ot">nil</span> <span class="op">{</span></span>
<span id="cb3-25"><a aria-hidden="true" href="#cb3-25" tabindex="-1"></a>        <span class="cf">return</span> badValueError<span class="op">{</span>value<span class="op">:</span> v<span class="op">,</span> err<span class="op">:</span> err<span class="op">}</span></span>
<span id="cb3-26"><a aria-hidden="true" href="#cb3-26" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-27"><a aria-hidden="true" href="#cb3-27" tabindex="-1"></a>    <span class="cf">return</span> <span class="ot">nil</span></span>
<span id="cb3-28"><a aria-hidden="true" href="#cb3-28" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>é€™å€‹ä¾‹å­çš„é‡é»æ˜¯æˆ‘å€‘çš„structå®šç¾©äº† <code>Unwrap()</code>
å‡½å¼ï¼Œåˆ©ç”¨é€™å€‹å‡½å¼ï¼Œ<code>erros.Is</code> å’Œ <code>errors.As</code>
æ‰èƒ½æ­£å¸¸é‹ä½œï¼Œä¸åªæ˜¯å˜—è©¦match
<code>badValueError{value: v, err: err}</code>é€™å€‹erorï¼Œé‚„æœƒä¸æ–·çš„å¾€ä¸‹å°‹æ‰¾æ˜¯å¦æœ‰å…¶ä»–èƒ½å°æ‡‰çš„errorã€‚</p>
<p>å¦ä¸€å€‹æˆ‘å€‘å¯ä»¥å®šç¾©çš„æ˜¯<code>Is(target error) bool</code>
é€™å€‹å‡½å¼ï¼Œä»–å¯ä»¥è®“ <code>errors.Is</code>
ä½¿ç”¨ï¼Œè¡¨ç¤ºæˆ‘å€‘å®šç¾©çš„é€™å€‹errorï¼Œå…¶å¯¦è·Ÿå¦å¤–æŸå€‹erroræ˜¯ç›¸ç­‰çš„ã€‚</p>
<h1 data-number="3" id="çµèª"><span class="header-section-number">3</span> çµèª</h1>
<p>åœ¨é€™ç¯‡æ–‡ç« ä¸­ï¼Œæ¢è¨äº†æˆ‘åœ¨ Go ä¸­å¸¸ä½¿ç”¨çš„error
handlingæŠ€å·§ï¼Œåœ¨1.13ä¹‹å¾Œï¼ŒGoæœ¬èº«æä¾›çš„error
handlingæ©Ÿåˆ¶ï¼Œçš„ç¢ºæ˜¯æ›´åŠ æˆç†Ÿäº†ã€‚</p></div></div></section></article><comment><script async="async" crossorigin="anonymous" data-category="General" data-category-id="DIC_kwDOD5Bpa84COAIg" data-emit-metadata="0" data-input-position="top" data-lang="en" data-mapping="pathname" data-reactions-enabled="0" data-repo="onemouth/onemouth.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkyNjExMjI0MTE=" data-theme="light" src="https://giscus.app/client.js"></script><script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script></comment></div></main>
]]></summary></entry><entry><title>[ç­†è¨˜] Goï¼šNil Map</title><link href="https://onemouth.github.io/posts/2022-07-14-go-empty-map.html" /><id>https://onemouth.github.io/posts/2022-07-14-go-empty-map.html</id><published>2022-07-14T12:00:00+08:00</published><updated>2022-07-14T12:00:00+08:00</updated><summary type="html"><![CDATA[<main><div><article><h1>[ç­†è¨˜]
Goï¼šNil Map</h1><section class="header">
Posted on Jul 14, 2022
by LT
</section><section><div class="sourceCode" id="cb1"><pre class="sourceCode go"><code class="sourceCode go"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a><span class="kw">package</span> main</span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a aria-hidden="true" href="#cb1-3" tabindex="-1"></a><span class="kw">import</span> <span class="op">(</span></span>
<span id="cb1-4"><a aria-hidden="true" href="#cb1-4" tabindex="-1"></a>    <span class="st">"fmt"</span></span>
<span id="cb1-5"><a aria-hidden="true" href="#cb1-5" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb1-6"><a aria-hidden="true" href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a aria-hidden="true" href="#cb1-7" tabindex="-1"></a><span class="kw">func</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-8"><a aria-hidden="true" href="#cb1-8" tabindex="-1"></a>    <span class="kw">var</span> m <span class="kw">map</span><span class="op">[</span><span class="dt">string</span><span class="op">]</span><span class="dt">int</span></span>
<span id="cb1-9"><a aria-hidden="true" href="#cb1-9" tabindex="-1"></a>    fmt<span class="op">.</span>Println<span class="op">(</span>m<span class="op">[</span><span class="st">"test"</span><span class="op">])</span></span>
<span id="cb1-10"><a aria-hidden="true" href="#cb1-10" tabindex="-1"></a>    m<span class="op">[</span><span class="st">"test"</span><span class="op">]++</span></span>
<span id="cb1-11"><a aria-hidden="true" href="#cb1-11" tabindex="-1"></a>    fmt<span class="op">.</span>Println<span class="op">(</span>m<span class="op">[</span><span class="st">"test"</span><span class="op">])</span></span>
<span id="cb1-12"><a aria-hidden="true" href="#cb1-12" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>ä¸Šé¢é€™æ®µcodeçš„è¼¸å‡ºç‚º0ï¼Œç„¶å¾Œpanicã€‚</p>
<p>åœ¨é€™å€‹ä¾‹å­ï¼Œmæ˜¯ä¸€å€‹nil mapã€‚åœ¨Goä¸­ï¼Œå°nil mapçš„æœ‰ä¸€äº›æ“ä½œæ˜¯â€nil
safeâ€çš„ï¼š</p>
<ul>
<li><code>len(m)</code>: 0</li>
<li><code>m[key]</code>
<ul>
<li>return the zero value for the value type if key is not in the
map</li>
<li>return the value assoiated with the key if key is in the map</li>
</ul></li>
</ul>
<p>åˆ©ç”¨ç¬¬äºŒå€‹æ€§è³ªï¼Œå‡å¦‚æ˜¯empty mapçš„è©±ï¼Œæˆ‘å€‘å¯ä»¥æœ‰åƒæ˜¯pythonçš„<a href="https://docs.python.org/3/library/collections.html#collections.defaultdict">defaultdict</a>çš„æ‡‰ç”¨ã€‚</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode go"><code class="sourceCode go"><span id="cb2-1"><a aria-hidden="true" href="#cb2-1" tabindex="-1"></a><span class="kw">package</span> main</span>
<span id="cb2-2"><a aria-hidden="true" href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a aria-hidden="true" href="#cb2-3" tabindex="-1"></a><span class="kw">import</span> <span class="op">(</span></span>
<span id="cb2-4"><a aria-hidden="true" href="#cb2-4" tabindex="-1"></a>    <span class="st">"fmt"</span></span>
<span id="cb2-5"><a aria-hidden="true" href="#cb2-5" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb2-6"><a aria-hidden="true" href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a aria-hidden="true" href="#cb2-7" tabindex="-1"></a><span class="kw">func</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb2-8"><a aria-hidden="true" href="#cb2-8" tabindex="-1"></a>    m <span class="op">:=</span> <span class="kw">map</span><span class="op">[</span><span class="dt">string</span><span class="op">]</span><span class="dt">int</span><span class="op">{}</span></span>
<span id="cb2-9"><a aria-hidden="true" href="#cb2-9" tabindex="-1"></a>    fmt<span class="op">.</span>Println<span class="op">(</span>m<span class="op">[</span><span class="st">"test"</span><span class="op">])</span></span>
<span id="cb2-10"><a aria-hidden="true" href="#cb2-10" tabindex="-1"></a>    m<span class="op">[</span><span class="st">"test"</span><span class="op">]++</span></span>
<span id="cb2-11"><a aria-hidden="true" href="#cb2-11" tabindex="-1"></a>    fmt<span class="op">.</span>Println<span class="op">(</span>m<span class="op">[</span><span class="st">"test"</span><span class="op">])</span></span>
<span id="cb2-12"><a aria-hidden="true" href="#cb2-12" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>é™¤äº†nil mapä»¥å¤–ï¼Œåƒæ˜¯nil slice, nil channelä¹Ÿéƒ½æœ‰ä¸€äº›â€nil
safeâ€çš„æ“ä½œã€‚</p>
<p>å°nil
sliceå¯ä»¥ç”¨<code>len</code>å–é•·åº¦ï¼Œä¹Ÿå¯ä»¥åš<code>append</code>æ“ä½œã€‚</p>
<p>ä¹Ÿå¯ä»¥å°nil channelåšreceive valueæˆ–send
valueçš„å‹•ä½œã€‚(é›–ç„¶é€™æ¨£æœƒæ°¸ä¹…blockä½)</p>
<h2 id="reference">Reference</h2>
<ol type="1">
<li><a href="https://pragprog.com/titles/d-gobrain/go-brain-teasers/">Go
Brain Teasers</a></li>
</ol></section></article><comment><script async="async" crossorigin="anonymous" data-category="General" data-category-id="DIC_kwDOD5Bpa84COAIg" data-emit-metadata="0" data-input-position="top" data-lang="en" data-mapping="pathname" data-reactions-enabled="0" data-repo="onemouth/onemouth.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkyNjExMjI0MTE=" data-theme="light" src="https://giscus.app/client.js"></script><script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script></comment></div></main>
]]></summary></entry><entry><title>å¦‚ä½•åœ¨Hakyllä¸­ç”¢ç”Ÿslide shows</title><link href="https://onemouth.github.io/posts/2022-05-15-hakyll-html5-slides.html" /><id>https://onemouth.github.io/posts/2022-05-15-hakyll-html5-slides.html</id><published>2022-05-15T12:00:00+08:00</published><updated>2022-05-15T12:00:00+08:00</updated><summary type="html"><![CDATA[<main><div><article><h1>å¦‚ä½•åœ¨Hakyllä¸­ç”¢ç”Ÿslide
shows</h1><section class="header">
Posted on May 15, 2022
by LT
</section><section><p>æˆ‘å€‘ä¸åªå¯ä»¥è®“Hykyllç”¢ç”ŸHTMLç¶²é ï¼Œå¾—åˆ©æ–¼HakyllèƒŒå¾Œçš„<a href="https://pandoc.org/">Pandoc</a>çš„å¼·å¤§èƒ½åŠ›ï¼Œåªè¦æ˜¯Pandocæ”¯æ´çš„æ ¼å¼ï¼Œå…¶å¯¦éƒ½å¯ä»¥è¼¸å‡ºã€‚</p>
<p>Pandocæ”¯æ´è¨±å¤šç¨®Slideæ ¼å¼ï¼Œåƒæ˜¯Slidyï¼Œreveal.jsï¼ŒDZSlides
ç­‰ç­‰ã€‚é€™ç¯‡blogä¸»è¦æœƒä»‹ç´¹å¦‚ä½•è®“Hakyllç”¢ç”Ÿreveal.jsçš„æ ¼å¼ã€‚</p>
<p>åœ¨é–‹å§‹ä¹‹å‰ï¼Œæˆ‘å€‘è¦å…ˆçœ‹ä¸€ä¸‹ï¼Œåœ¨Hakyllè£¡é¢ï¼Œä¸€å€‹Itemçš„pandoc
compileçš„æµç¨‹å¤§è‡´æ˜¯æ€éº¼çš„ã€‚</p>
<h2 id="pandoc-compile-æµç¨‹">Pandoc Compile æµç¨‹</h2>
<p>åˆ©ç”¨ä¸‹é¢çš„å‡½å¼ï¼Œæˆ‘å€‘å¯ä»¥æŠŠä¸€å€‹Itemï¼Œç¶“éPandocä¹‹å¾Œï¼Œè½‰æ›æˆHTMLæ ¼å¼ã€‚</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a><span class="co">-- è®€å–æª”æ¡ˆå…§å®¹</span></span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2" tabindex="-1"></a><span class="ot">getResourceBody ::</span> <span class="dt">Compiler</span> (<span class="dt">Item</span> <span class="dt">String</span>)</span>
<span id="cb1-3"><a aria-hidden="true" href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a aria-hidden="true" href="#cb1-4" tabindex="-1"></a><span class="co">-- å°‡æª”æ¡ˆå…§å®¹è½‰æ›ç‚ºPandocå…§éƒ¨è³‡æ–™çµæ§‹</span></span>
<span id="cb1-5"><a aria-hidden="true" href="#cb1-5" tabindex="-1"></a><span class="ot">readPandoc ::</span> <span class="dt">Item</span> <span class="dt">String</span>  <span class="ot">-&gt;</span> <span class="dt">Compiler</span> (<span class="dt">Item</span> <span class="dt">Pandoc</span>) </span>
<span id="cb1-6"><a aria-hidden="true" href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a aria-hidden="true" href="#cb1-7" tabindex="-1"></a><span class="co">-- å¾Pandocå…§éƒ¨è³‡æ–™çµæ§‹è½‰æ›ç‚ºHTMLæ ¼å¼</span></span>
<span id="cb1-8"><a aria-hidden="true" href="#cb1-8" tabindex="-1"></a><span class="ot">writePandoc ::</span> <span class="dt">Item</span> <span class="dt">Pandoc</span> </span>
<span id="cb1-9"><a aria-hidden="true" href="#cb1-9" tabindex="-1"></a>            <span class="ot">-&gt;</span> <span class="dt">Item</span> <span class="dt">String</span> </span></code></pre></div>
<p>ä¹Ÿå°±æ˜¯å¯ä»¥çµ„åˆæˆä¸‹é¢çš„ snippetï¼š</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb2-1"><a aria-hidden="true" href="#cb2-1" tabindex="-1"></a>compile <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb2-2"><a aria-hidden="true" href="#cb2-2" tabindex="-1"></a>          getResourceBody</span>
<span id="cb2-3"><a aria-hidden="true" href="#cb2-3" tabindex="-1"></a>          <span class="op">&gt;&gt;=</span> readPandoc</span>
<span id="cb2-4"><a aria-hidden="true" href="#cb2-4" tabindex="-1"></a>          <span class="op">&gt;&gt;=</span> writePandoc</span>
<span id="cb2-5"><a aria-hidden="true" href="#cb2-5" tabindex="-1"></a>          <span class="co">-- ....</span></span></code></pre></div>
<p>å› ç‚ºé€™å€‹å¥—è·¯è »å›ºå®šçš„ï¼Œæ‰€ä»¥Hakyllç›´æ¥æä¾›äº†ä¸€å€‹<code>pandocCompiler</code>ï¼Œç­‰åŒæ–¼ä¸Šé¢ä¸‰å€‹çš„çµ„åˆ</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb3-1"><a aria-hidden="true" href="#cb3-1" tabindex="-1"></a><span class="co">-- è®€å–æª”æ¡ˆå…§å®¹ï¼Œç¶“ç”±Pandocè™•ç†å¾Œè¼¸å‡ºã€‚</span></span>
<span id="cb3-2"><a aria-hidden="true" href="#cb3-2" tabindex="-1"></a><span class="ot">pandocCompiler ::</span> <span class="dt">Compiler</span> (<span class="dt">Item</span> <span class="dt">String</span>)</span></code></pre></div>
<p>é€™é‚Šè¦æ³¨æ„çš„æ˜¯ï¼Œ<code>writePandoc</code>
å¿…å®šæ˜¯ç”¢ç”ŸHTMLæ ¼å¼ï¼Œä¹Ÿå°±æ˜¯èªªï¼Œå®ƒå‘¼å«çš„æ˜¯Pandocçš„<a href="https://hackage.haskell.org/package/pandoc-2.2/docs/Text-Pandoc-Writers-HTML.html#v:writeHtml5String">writeHtml5String</a>é€™å€‹å‡½å¼ã€‚ä½†å› ç‚ºæˆ‘å€‘æƒ³è¦ç”¢ç”Ÿreveal.jsæ ¼å¼ï¼Œæ‰€ä»¥æ‡‰è©²è¦ä½¿ç”¨<a href="https://hackage.haskell.org/package/pandoc-2.2/docs/Text-Pandoc-Writers-HTML.html#v:writeRevealJs">writeRevealJs</a>å‡½å¼æ‰å°ã€‚</p>
<h2 id="å®šç¾©è‡ªå·±çš„-writepandoc">å®šç¾©è‡ªå·±çš„ writePandoc</h2>
<p>ä¹Ÿå°±æ˜¯èªªï¼Œæˆ‘å€‘ä¸èƒ½ä½¿ç”¨é è¨­çš„<code>writePandoc</code>å‡½å¼ï¼Œè€Œæ‡‰è©²è‡ªå®šç¾©ä¸€å€‹<code>writePandocToRevealJs</code>ï¼Œä¸¦åœ¨è£¡é¢å‘¼å«Pandocçš„<a href="https://hackage.haskell.org/package/pandoc-2.2/docs/Text-Pandoc-Writers-HTML.html#v:writeRevealJs">writeRevealJs</a>å‡½å¼ã€‚</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb4-1"><a aria-hidden="true" href="#cb4-1" tabindex="-1"></a><span class="ot">writePandocToRevealJs ::</span> <span class="dt">Item</span> <span class="dt">Pandoc</span> <span class="ot">-&gt;</span> <span class="dt">Compiler</span> (<span class="dt">Item</span> <span class="dt">String</span>)</span>
<span id="cb4-2"><a aria-hidden="true" href="#cb4-2" tabindex="-1"></a>writePandocToRevealJs <span class="ot">=</span> <span class="fu">traverse</span> <span class="op">$</span> \pandoc <span class="ot">-&gt;</span></span>
<span id="cb4-3"><a aria-hidden="true" href="#cb4-3" tabindex="-1"></a>  <span class="kw">case</span> runPure (PandocWriter.writeRevealJs slidesWriterOptions pandoc) <span class="kw">of</span></span>
<span id="cb4-4"><a aria-hidden="true" href="#cb4-4" tabindex="-1"></a>    <span class="dt">Left</span> err <span class="ot">-&gt;</span> <span class="fu">fail</span> <span class="op">$</span> <span class="fu">show</span> err</span>
<span id="cb4-5"><a aria-hidden="true" href="#cb4-5" tabindex="-1"></a>    <span class="dt">Right</span> x <span class="ot">-&gt;</span> <span class="fu">return</span> (T.unpack x)</span>
<span id="cb4-6"><a aria-hidden="true" href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a aria-hidden="true" href="#cb4-7" tabindex="-1"></a></span>
<span id="cb4-8"><a aria-hidden="true" href="#cb4-8" tabindex="-1"></a><span class="ot">slidesWriterOptions ::</span> <span class="dt">WriterOptions</span></span>
<span id="cb4-9"><a aria-hidden="true" href="#cb4-9" tabindex="-1"></a>slidesWriterOptions <span class="ot">=</span></span>
<span id="cb4-10"><a aria-hidden="true" href="#cb4-10" tabindex="-1"></a>  defaultHakyllWriterOptions</span>
<span id="cb4-11"><a aria-hidden="true" href="#cb4-11" tabindex="-1"></a>    { writerHTMLMathMethod <span class="ot">=</span> <span class="dt">MathJax</span> <span class="st">""</span> <span class="co">-- ä½¿ç”¨MathJax</span></span>
<span id="cb4-12"><a aria-hidden="true" href="#cb4-12" tabindex="-1"></a>    }</span></code></pre></div>
<p>è€Œæ•´å€‹Rule monadå°±æœƒåƒä¸‹åˆ—é€™æ¨£ï¼š</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb5-1"><a aria-hidden="true" href="#cb5-1" tabindex="-1"></a>  match <span class="st">"slides/*"</span> <span class="op">$</span></span>
<span id="cb5-2"><a aria-hidden="true" href="#cb5-2" tabindex="-1"></a>    <span class="kw">do</span></span>
<span id="cb5-3"><a aria-hidden="true" href="#cb5-3" tabindex="-1"></a>      route <span class="op">$</span> setExtension <span class="st">"html"</span></span>
<span id="cb5-4"><a aria-hidden="true" href="#cb5-4" tabindex="-1"></a>      compile <span class="op">$</span></span>
<span id="cb5-5"><a aria-hidden="true" href="#cb5-5" tabindex="-1"></a>        <span class="kw">do</span> getResourceBody</span>
<span id="cb5-6"><a aria-hidden="true" href="#cb5-6" tabindex="-1"></a>          <span class="op">&gt;&gt;=</span> readPandoc</span>
<span id="cb5-7"><a aria-hidden="true" href="#cb5-7" tabindex="-1"></a>          <span class="op">&gt;&gt;=</span> writePandocToRevealJs</span>
<span id="cb5-8"><a aria-hidden="true" href="#cb5-8" tabindex="-1"></a>          <span class="op">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">"templates/revealjs.html"</span> postCtx</span>
<span id="cb5-9"><a aria-hidden="true" href="#cb5-9" tabindex="-1"></a>          <span class="op">&gt;&gt;=</span> relativizeUrls</span>
<span id="cb5-10"><a aria-hidden="true" href="#cb5-10" tabindex="-1"></a></span></code></pre></div></section></article><comment><script async="async" crossorigin="anonymous" data-category="General" data-category-id="DIC_kwDOD5Bpa84COAIg" data-emit-metadata="0" data-input-position="top" data-lang="en" data-mapping="pathname" data-reactions-enabled="0" data-repo="onemouth/onemouth.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkyNjExMjI0MTE=" data-theme="light" src="https://giscus.app/client.js"></script><script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script></comment></div></main>
]]></summary></entry><entry><title>å¦‚ä½•åœ¨Hakyllä¸­è¨­å®šAtom/RSS Feed</title><link href="https://onemouth.github.io/posts/2022-05-06-hakyll-atom-setup.html" /><id>https://onemouth.github.io/posts/2022-05-06-hakyll-atom-setup.html</id><published>2022-05-06T12:00:00+08:00</published><updated>2022-05-06T12:00:00+08:00</updated><summary type="html"><![CDATA[<main><div><article><h1>å¦‚ä½•åœ¨Hakyllä¸­è¨­å®šAtom/RSS
Feed</h1><section class="header">
Posted on May 06, 2022
by LT
</section><section><p>é¦–å…ˆé€™æ˜¯ç”¢ç”ŸAtom Feed çš„functionï¼š</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a><span class="ot">renderAtom ::</span> <span class="dt">FeedConfiguration</span></span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2" tabindex="-1"></a>           <span class="ot">-&gt;</span> <span class="dt">Context</span> <span class="dt">String</span></span>
<span id="cb1-3"><a aria-hidden="true" href="#cb1-3" tabindex="-1"></a>           <span class="ot">-&gt;</span> [<span class="dt">Item</span> <span class="dt">String</span>]</span>
<span id="cb1-4"><a aria-hidden="true" href="#cb1-4" tabindex="-1"></a>           <span class="ot">-&gt;</span> <span class="dt">Compiler</span> (<span class="dt">Item</span> <span class="dt">String</span>)</span></code></pre></div>
<p>å¾function signature
å¯ä»¥çŒœå‡ºä¾†ï¼Œç¬¬ä¸€å€‹åƒæ•¸æ˜¯é—œæ–¼Configurationï¼Œç¬¬äºŒå€‹åƒæ•¸æˆ‘å€‘å…ˆä¸ç®¡å®ƒï¼Œç¬¬ä¸‰å€‹åƒæ•¸æ˜¯<code>[Item String]</code>ï¼Œä¹Ÿå°±æ˜¯æˆ‘å€‘è¦ç”¢ç”ŸFeedçš„ä¸»è¦å…§å®¹ã€‚å› ç‚º<code>renderAtom</code>çš„è¿”å›å€¼æ˜¯ä¸€å€‹<code>Compiler (Item String)</code>ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥ç›´æ¥å‚³çµ¦compiler
functionï¼š</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb2-1"><a aria-hidden="true" href="#cb2-1" tabindex="-1"></a></span>
<span id="cb2-2"><a aria-hidden="true" href="#cb2-2" tabindex="-1"></a>  match <span class="st">"posts/*"</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb2-3"><a aria-hidden="true" href="#cb2-3" tabindex="-1"></a>    route <span class="op">$</span> setExtension <span class="st">"html"</span></span>
<span id="cb2-4"><a aria-hidden="true" href="#cb2-4" tabindex="-1"></a>    compile <span class="op">$</span> pandocCompiler</span>
<span id="cb2-5"><a aria-hidden="true" href="#cb2-5" tabindex="-1"></a>        <span class="op">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">"templates/post.html"</span>    postCtx</span>
<span id="cb2-6"><a aria-hidden="true" href="#cb2-6" tabindex="-1"></a>        <span class="op">&gt;&gt;=</span> saveSnapshot <span class="st">"content"</span></span>
<span id="cb2-7"><a aria-hidden="true" href="#cb2-7" tabindex="-1"></a>        <span class="op">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">"templates/default.html"</span> postCtx</span>
<span id="cb2-8"><a aria-hidden="true" href="#cb2-8" tabindex="-1"></a>        <span class="op">&gt;&gt;=</span> relativizeUrls</span>
<span id="cb2-9"><a aria-hidden="true" href="#cb2-9" tabindex="-1"></a></span>
<span id="cb2-10"><a aria-hidden="true" href="#cb2-10" tabindex="-1"></a>  create [<span class="st">"atom.xml"</span>] <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb2-11"><a aria-hidden="true" href="#cb2-11" tabindex="-1"></a>    route idRoute</span>
<span id="cb2-12"><a aria-hidden="true" href="#cb2-12" tabindex="-1"></a>    compile <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb2-13"><a aria-hidden="true" href="#cb2-13" tabindex="-1"></a>      posts <span class="ot">&lt;-</span> <span class="fu">fmap</span> (<span class="fu">take</span> <span class="dv">15</span>) <span class="op">.</span> recentFirst <span class="op">=&lt;&lt;</span> loadAllSnapshots <span class="st">"posts/*"</span> <span class="st">"content"</span></span>
<span id="cb2-14"><a aria-hidden="true" href="#cb2-14" tabindex="-1"></a>      renderAtom feedConfiguration <span class="op">?</span> posts</span>
<span id="cb2-15"><a aria-hidden="true" href="#cb2-15" tabindex="-1"></a></span>
<span id="cb2-16"><a aria-hidden="true" href="#cb2-16" tabindex="-1"></a><span class="ot"> feedConfiguration ::</span> <span class="dt">FeedConfiguration</span></span>
<span id="cb2-17"><a aria-hidden="true" href="#cb2-17" tabindex="-1"></a> feedConfiguration <span class="ot">=</span></span>
<span id="cb2-18"><a aria-hidden="true" href="#cb2-18" tabindex="-1"></a>   <span class="dt">FeedConfiguration</span></span>
<span id="cb2-19"><a aria-hidden="true" href="#cb2-19" tabindex="-1"></a>   { feedTitle <span class="ot">=</span> <span class="st">"Put some ink into the inkpot"</span>,</span>
<span id="cb2-20"><a aria-hidden="true" href="#cb2-20" tabindex="-1"></a>     feedDescription <span class="ot">=</span> <span class="st">"Put some ink into the inkpot - a personal blog"</span>,</span>
<span id="cb2-21"><a aria-hidden="true" href="#cb2-21" tabindex="-1"></a>     feedAuthorName <span class="ot">=</span> <span class="st">"LT Tsai"</span>,</span>
<span id="cb2-22"><a aria-hidden="true" href="#cb2-22" tabindex="-1"></a>     feedAuthorEmail <span class="ot">=</span> <span class="st">"lt@ltt.pw"</span>,</span>
<span id="cb2-23"><a aria-hidden="true" href="#cb2-23" tabindex="-1"></a>     feedRoot <span class="ot">=</span> <span class="st">"https://onemouth.github.io"</span></span>
<span id="cb2-24"><a aria-hidden="true" href="#cb2-24" tabindex="-1"></a>   }</span></code></pre></div>
<p>é‚£æˆ‘å€‘ç¾åœ¨å°±åªå‰©ä¸‹ç¬¬äºŒå€‹åƒæ•¸<code>Context String</code>äº†ï¼Œé¦–å…ˆæˆ‘å€‘è¦çŸ¥é“ï¼Œåœ¨Hakyllä¸­ï¼Œ<code>Context</code>ä»£è¡¨çš„æ˜¯å¾ˆå¤škey-valueæ‰€å½¢æˆçš„ä¸€å€‹é›†åˆã€‚æ­¤å¤–ï¼Œ
<code>Context</code>æ˜¯ä¸€å€‹Monoidï¼Œæ‰€ä»¥ç”¨<code>mappend</code>å°±å¯ä»¥æ–°å¢key-valueåˆ°<code>Conxtext</code>è£¡é¢ã€‚è€Œç•¶templateéœ€è¦æŸä¸€å€‹keyçš„å€¼ï¼Œå°±å¯ä»¥å¾<code>Context</code>ä¸­ç²å¾—ã€‚</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb3-1"><a aria-hidden="true" href="#cb3-1" tabindex="-1"></a><span class="ot">postCtx ::</span> <span class="dt">Context</span> <span class="dt">String</span></span>
<span id="cb3-2"><a aria-hidden="true" href="#cb3-2" tabindex="-1"></a>postCtx <span class="ot">=</span></span>
<span id="cb3-3"><a aria-hidden="true" href="#cb3-3" tabindex="-1"></a>  dateField <span class="st">"date"</span> <span class="st">"%B %e, %Y"</span></span>
<span id="cb3-4"><a aria-hidden="true" href="#cb3-4" tabindex="-1"></a>    <span class="ot">`mappend`</span> defaultContext</span>
<span id="cb3-5"><a aria-hidden="true" href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a aria-hidden="true" href="#cb3-6" tabindex="-1"></a><span class="ot">feedCtx ::</span> <span class="dt">Context</span> <span class="dt">String</span></span>
<span id="cb3-7"><a aria-hidden="true" href="#cb3-7" tabindex="-1"></a>feedCtx <span class="ot">=</span> postCtx <span class="op">&lt;&gt;</span> bodyField <span class="st">"description"</span> </span></code></pre></div>
<p>defaultContextè£¡é¢çš„keyåŒ…æ‹¬:</p>
<ul>
<li><code>$body$</code>: Item çš„å…§å®¹</li>
<li><code>$url$</code>: Item çš„URL</li>
<li><code>$path$</code>: Item çš„åŸå§‹æª”æ¡ˆè·¯å¾‘</li>
<li><code>$foo$</code>: ä»»ä½•åŒ…æ‹¬åœ¨Metadataä¸­çš„è³‡æ–™</li>
</ul>
<p>defaultContext
ä¸¦ä¸åŒ…å«dateçš„è³‡è¨Šï¼Œæ‰€ä»¥æˆ‘å€‘ç”¨<code>dateField</code>æŠŠå¯«åœ¨æª”æ¡ˆè·¯å¾‘çš„æ—¥æœŸparseå‡ºä¾†ï¼Œä¸¦æ”¾åœ¨<code>postCtx</code>è£¡é¢ã€‚</p>
<p>å¦å¤–ï¼Œåœ¨feedçš„é è¨­templateè£¡é¢ï¼Œéœ€è¦ä¸€å€‹descriptionçš„keyï¼Œè€Œåœ¨ç›®å‰å¤§éƒ¨åˆ†RSSçš„ç¶²ç«™å¯¦ä½œä¸­ï¼Œdescriptionéƒ½æ˜¯ç›´æ¥æ”¾æ–‡ç« çš„å®Œæ•´å…§å®¹ï¼Œæ‰€ä»¥é€™é‚Šæˆ‘å€‘ç”¨<code>bodyField</code>ï¼ŒæŠŠdescriptionæŒ‡å‘bodyçš„å…§å®¹ã€‚</p>
<p>æœ€å¾Œï¼Œæˆ‘å€‘ç”¢ç”ŸFeedçš„ç¨‹å¼ç¢¼å°±åƒé€™æ¨£ï¼š</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb4-1"><a aria-hidden="true" href="#cb4-1" tabindex="-1"></a>  create [<span class="st">"atom.xml"</span>] <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb4-2"><a aria-hidden="true" href="#cb4-2" tabindex="-1"></a>    route idRoute</span>
<span id="cb4-3"><a aria-hidden="true" href="#cb4-3" tabindex="-1"></a>    compile <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb4-4"><a aria-hidden="true" href="#cb4-4" tabindex="-1"></a>      posts <span class="ot">&lt;-</span> <span class="fu">fmap</span> (<span class="fu">take</span> <span class="dv">15</span>) <span class="op">.</span> recentFirst <span class="op">=&lt;&lt;</span> loadAllSnapshots <span class="st">"posts/*"</span> <span class="st">"content"</span></span>
<span id="cb4-5"><a aria-hidden="true" href="#cb4-5" tabindex="-1"></a>      renderAtom feedConfiguration feedCtx posts</span></code></pre></div></section></article><comment><script async="async" crossorigin="anonymous" data-category="General" data-category-id="DIC_kwDOD5Bpa84COAIg" data-emit-metadata="0" data-input-position="top" data-lang="en" data-mapping="pathname" data-reactions-enabled="0" data-repo="onemouth/onemouth.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkyNjExMjI0MTE=" data-theme="light" src="https://giscus.app/client.js"></script><script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script></comment></div></main>
]]></summary></entry><entry><title>iCloudä¸Šçš„é…·æ±è¥¿-è‡ªè¨‚é›»å­éƒµä»¶ç¶²åŸŸ</title><link href="https://onemouth.github.io/posts/2022-05-03-icloud-cool-things.html" /><id>https://onemouth.github.io/posts/2022-05-03-icloud-cool-things.html</id><published>2022-05-03T12:00:00+08:00</published><updated>2022-05-03T12:00:00+08:00</updated><summary type="html"><![CDATA[<main><div><article><h1>iCloudä¸Šçš„é…·æ±è¥¿-è‡ªè¨‚é›»å­éƒµä»¶ç¶²åŸŸ</h1><section class="header">
Posted on May 03, 2022
by LT
</section><section><p>å¾2019é–‹å§‹å°±é–‹å§‹è¨‚é–±iCloudçš„å„²å­˜ç©ºé–“200Gï¼Œå› ç‚ºå…è²»çš„5GBå¯¦åœ¨ä¸å¤ ï¼ŒåŠ ä¸Šå¯ä»¥å’Œå®¶äººå…±äº«ï¼Œå°±ä¸€ç›´è¨‚é–±è‘—ï¼Œå¹³å¸¸ä¹Ÿä¸æœƒå»æ³¨æ„å®ƒæœ‰ä»€éº¼æ–°åŠŸèƒ½ã€‚</p>
<p>æœ€è¿‘æ‰ç™¼ç¾ï¼Œé€™å€‹è¨‚é–±æœå‹™æ—©åœ¨2021å°±è®Šæˆäº†<a href="https://support.apple.com/zh-tw/HT201238">iCloud
Plus</a>ï¼Œä¸»è¦å¢åŠ äº†å¹¾å€‹åŠŸèƒ½:</p>
<ul>
<li>éš±è—æˆ‘çš„é›»å­éƒµä»¶</li>
<li><a href="https://support.apple.com/en-us/HT212514">è‡ªè¨‚é›»å­éƒµä»¶ç¶²åŸŸ</a></li>
<li>HomeKitå®‰å…¨éŒ„å½±</li>
</ul>
<p>å‰›å¥½æœ€è¿‘æ‰‹ä¸Šæœ‰å€‹ç¶²åŸŸï¼Œæˆ‘ä¹Ÿä¸€ç›´æƒ³ç”¨ç¶å€‹è‡ªå·±ç¶²åŸŸçš„emailå¸³è™Ÿï¼Œè€Œä¸è¦å†ç”¨<code>@gmail.com</code>ï¼Œå› ç‚ºç”¨è‡ªå·±çš„ç¶²åŸŸï¼Œæ„Ÿè¦ºæ¯”è¼ƒå°ˆæ¥­(?)</p>
<p>ç•¶ç„¶ä¹Ÿå¯ä»¥è€ƒæ…®è‡ªå·±æ¶ï¼Œæ”¶ä¿¡ä¼¼ä¹ä¸é›£ï¼Œä½†æ˜¯å¯„ä¿¡éå¸¸å®¹æ˜“è¢«ç•¶æˆåƒåœ¾éƒµä»¶ä¸Ÿæ‰ï¼Œè¦è¨­å®šå¥½<a href="https://en.wikipedia.org/wiki/Sender_Policy_Framework">SPF</a>ï¼Œ<a href="https://en.wikipedia.org/wiki/DomainKeys_Identified_Mail">DKIM</a>å’Œ<a href="https://en.wikipedia.org/wiki/DMARC">DMARC</a>ä¹‹é¡æ±è¥¿çš„æ¨£å­â€¦æ‰€ä»¥ç¶²è·¯ä¸Šå»ºè­°å¯„ä¿¡çš„è©±å†è½‰çµ¦Amazon
SESè™•ç†ï¼Œæƒ³æƒ³é‚„æ˜¯è »è¤‡é›œçš„ã€‚</p>
<p>é›²ç«¯æœå‹™çš„è©±ï¼ŒGmailåªæœ‰ä¼æ¥­ç‰ˆæ‰æä¾›è‡ªè¨‚ç¶²åŸŸçš„åŠŸèƒ½ï¼Œå…¶ä»–åƒ<a href="https://protonmail.com/support/knowledge-base/paid-plans/">ProtonMail</a>é›–ç„¶åœ¨ä»˜è²»ç‰ˆä¹Ÿæœ‰æä¾›è‡ªè¨‚ç¶²åŸŸï¼Œä½†æ¯å€‹æœˆé‚„è¦å†å¤šä»˜ç´„100å…ƒå°å¹£è¨‚é–±ï¼Œæƒ³äº†æƒ³ï¼Œé‚„æ˜¯ç”¨iCloud
Plusçš„å°±å¥½ï¼Œç•¢ç«ŸåŠ é‡ä¸åŠ åƒ¹ï¼</p>
<p>æˆ‘çš„emailï¼š lt at ltt.pw</p>
<p>è«‹å¤šæŒ‡æ•™!</p></section></article><comment><script async="async" crossorigin="anonymous" data-category="General" data-category-id="DIC_kwDOD5Bpa84COAIg" data-emit-metadata="0" data-input-position="top" data-lang="en" data-mapping="pathname" data-reactions-enabled="0" data-repo="onemouth/onemouth.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkyNjExMjI0MTE=" data-theme="light" src="https://giscus.app/client.js"></script><script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script></comment></div></main>
]]></summary></entry><entry><title>10éš»è€é¼ å’Œ1000å€‹ç“¶å­ï¼Œå…¶ä¸­ä¸€ç“¶æœ‰æ¯’è—¥</title><link href="https://onemouth.github.io/posts/2022-03-12-poision-and-rats.html" /><id>https://onemouth.github.io/posts/2022-03-12-poision-and-rats.html</id><published>2022-03-12T12:00:00+08:00</published><updated>2022-03-12T12:00:00+08:00</updated><summary type="html"><![CDATA[<main><div><article><h1>10éš»è€é¼ å’Œ1000å€‹ç“¶å­ï¼Œå…¶ä¸­ä¸€ç“¶æœ‰æ¯’è—¥</h1><section class="header">
Posted on Mar 12, 2022
by LT
</section><section><p>ç¾åœ¨æœ‰10éš»è€é¼ å’Œ1000å€‹ç“¶å­ï¼Œå…¶ä¸­ä¸€ç“¶æœ‰æ¯’è—¥ï¼Œå¦å¤–999ç“¶è£¡é¢æ˜¯æ™®é€šçš„æ°´ã€‚å¾å¤–è§€ä¸Šåˆ†è¾¨ä¸å‡ºæ°´å’Œæ¯’è—¥ã€‚å–ä¸‹æ¯’è—¥çš„ç”Ÿç‰©æœƒåœ¨ä¸€æ˜ŸæœŸä¹‹å¾Œæ­»äº¡ï¼Œä½ å¦‚ä½•åˆ©ç”¨æ‰‹ä¸Šçš„è€é¼ ï¼Œåœ¨ä¸€æ˜ŸæœŸä¹‹å¾Œï¼Œæ­£ç¢ºå›ç­”é‚£å€‹ç“¶å­è£¡é¢è£çš„æ˜¯æ¯’è—¥ï¼Ÿ</p>
<p>é€™æ˜¯æˆ‘åœ¨é¢è©¦çš„æ™‚å€™ï¼Œè¢«å¯¦éš›å•åˆ°çš„å•é¡Œï¼Œç•¶ä¸‹å› ç‚ºç¬¬ä¸€å€‹æƒ³æ³•æ˜¯æƒ³ç”¨binary
searchä¾†åšï¼Œä½†ç”¨binary
searchçš„è©±ï¼Œéœ€è¦å¤šæ¬¡å¯¦é©—ï¼Œæ²’è¾¦æ³•åœ¨ä¸€æ˜ŸæœŸä¹‹å¾Œç«‹åˆ»å¾—åˆ°çµæœï¼Œæ‰€ä»¥åœ¨æ²’å¾—åˆ°é€²ä¸€æ­¥æç¤ºçš„æƒ…æ³ä¸‹ï¼Œå°±å¡ä½äº†ã€‚</p>
<p>ä¸Šç¶²æ‰¾äº†ä¸€ä¸‹ï¼Œä¼¼ä¹ä¹Ÿæ˜¯ä¸€é“ç¶“å…¸é¡Œäº†ã€‚æˆ‘å€‘å…ˆæŠŠå•é¡Œç°¡åŒ–ä¸€ä¸‹ï¼Œå‡è¨­ç¾åœ¨æ˜¯3éš»è€é¼ å’Œ8å€‹ç“¶å­ï¼Œå…¶ä¸­ä¸€ç“¶æœ‰æ¯’è—¥ï¼Œè¦å¦‚ä½•åœ¨ä¸€æ˜ŸæœŸå¾Œæ‰¾å‡ºä¾†å‘¢ï¼Ÿ</p>
<p>å› ç‚ºæˆ‘å€‘ç¾åœ¨æ‰‹ä¸Šæœ‰3éš»è€é¼ ï¼Œå‡è¨­ç·¨è™Ÿç‚º<code>A</code>,<code>B</code>,<code>C</code>ï¼Œç„¶å¾Œæˆ‘å€‘ç”¨<code>1</code>ä»£è¡¨è€é¼ æ­»äº¡ï¼Œç”¨<code>0</code>ä»£è¡¨è€é¼ å­˜æ´»ï¼Œåœ¨ä¸€æ˜ŸæœŸä¹‹å¾Œå…¨éƒ¨è€é¼ çš„å­˜æ´»æƒ…å½¢å¦‚ä¸‹ï¼š</p>
<table>
<caption>3éš»è€é¼ çš„å­˜æ´»ç‹€æ…‹</caption>
<thead>
<tr>
<th>A</th>
<th>B</th>
<th>C</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>ä¹Ÿå°±æ˜¯èªªï¼Œè€é¼ çš„æ­»æ´»æƒ…å½¢ï¼Œå‰›å¥½æœ‰8ç¨®
(2^3)ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥è©¦è‘—æŠŠé€™8ç¨®æƒ…å½¢å°æ‡‰åˆ°8å€‹ç“¶å­ä¸Šï¼Œå‡å¦‚ä¸‰éš»è€é¼ éƒ½æ´»è‘—ï¼Œé‚£å°±æ˜¯ç¬¬ä¸€å€‹ç“¶å­æœ‰æ¯’è—¥ï¼Œå‡å¦‚ä¸‰éš»éƒ½æ­»äº†ï¼Œé‚£å°±æ˜¯ç¬¬å…«å€‹ç“¶å­æœ‰æ¯’è—¥ï¼Œä»¥æ­¤é¡æ¨ã€‚</p>
<p>å¾é€™å€‹è¡¨ï¼Œç”±ä¸Šå¾€ä¸‹ï¼Œå°±æ˜¯3éš»è€é¼ å€‹åˆ¥éœ€è¦å–çš„ç“¶å­ï¼Œ<code>A</code>è€é¼ éœ€è¦å–ç¬¬5,6,7,8è™Ÿç“¶å­ï¼Œ<code>B</code>è€é¼ éœ€è¦å–3,4,7,8è™Ÿç“¶å­ï¼Œ<code>C</code>è€é¼ å‰‡éœ€è¦å–2,4,6,8è™Ÿç“¶å­ã€‚</p>
<p>é€™æ˜¯3éš»è€é¼ çš„æƒ…å½¢ï¼Œç­è§£ä¹‹å¾Œï¼Œè¦æ¨å»£åˆ°10éš»è€é¼ çš„æƒ…å½¢ä¹Ÿå¾ˆå®¹æ˜“äº†ï¼</p></section></article><comment><script async="async" crossorigin="anonymous" data-category="General" data-category-id="DIC_kwDOD5Bpa84COAIg" data-emit-metadata="0" data-input-position="top" data-lang="en" data-mapping="pathname" data-reactions-enabled="0" data-repo="onemouth/onemouth.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkyNjExMjI0MTE=" data-theme="light" src="https://giscus.app/client.js"></script><script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script></comment></div></main>
]]></summary></entry><entry><title>ä¸‰å€‹å­¸æ—¥æ–‡å¿…å‚™çš„ç€è¦½å™¨æ“´å……å¥—ä»¶</title><link href="https://onemouth.github.io/posts/2022-03-10-japanese-plugins.html" /><id>https://onemouth.github.io/posts/2022-03-10-japanese-plugins.html</id><published>2022-03-10T12:00:00+08:00</published><updated>2022-03-10T12:00:00+08:00</updated><summary type="html"><![CDATA[<main><div><article><h1>ä¸‰å€‹å­¸æ—¥æ–‡å¿…å‚™çš„ç€è¦½å™¨æ“´å……å¥—ä»¶</h1><section class="header">
Posted on Mar 10, 2022
by LT
</section><section><div><div class="toc"><div class="header">Table of Contents</div><ul>
<li><a href="#yomichan" id="toc-yomichan"><span class="toc-section-number">1</span> Yomichan</a></li>
<li><a href="#absolute-enable-right-click-copy" id="toc-absolute-enable-right-click-copy"><span class="toc-section-number">2</span> Absolute Enable Right Click &amp;
Copy</a></li>
<li><a href="#google-search---geolocation-language-change" id="toc-google-search---geolocation-language-change"><span class="toc-section-number">3</span> Google Search - Geolocation &amp;
Language Change</a></li>
<li><a href="#å°çµ" id="toc-å°çµ"><span class="toc-section-number">4</span> å°çµ</a></li>
</ul></div><div><p>åœ¨å­¸ç¿’æ—¥æ–‡çš„éç¨‹ä¸­ï¼Œä¹Ÿæ…¢æ…¢åœ°ä½¿ç”¨ä¸€äº›æ“´å……å¥—ä»¶ä¾†å¢é€²å­¸ç¿’çš„æ•ˆæœï¼Œæ‰€ä»¥æƒ³ä»‹ç´¹ä¸‰å€‹æˆ‘è¦ºå¾—æ˜¯å¿…å‚™çš„æ“´å……å¥—ä»¶ã€‚åˆ†åˆ¥ç‚º:</p>
<ul>
<li>Yomichan (<a href="https://addons.mozilla.org/zh-TW/firefox/addon/yomichan/">Firefox</a>,
<a href="https://chrome.google.com/webstore/detail/yomichan/ogmnaimimemjmbakcfefmnahgdfhfami">Chrome</a>)</li>
<li>Absolute Enable Right Click &amp; Copy (<a href="https://addons.mozilla.org/zh-TW/firefox/addon/absolute-enable-right-click/">Firefox</a>,
<a href="https://chrome.google.com/webstore/detail/absolute-enable-right-cli/jdocbkpgdakpekjlhemmfcncgdjeiika">Chrome</a>)</li>
<li>Google Search - Geolocation &amp; Language Change (<a href="https://addons.mozilla.org/zh-TW/firefox/addon/googlesearchgeolocationlang/">Firefox</a>,
<a href="https://chrome.google.com/webstore/detail/google-search-geolocation/gglakldnncaidfodbmpaodhdknnlkjbb">Chrome</a>)</li>
</ul>
<p>å…¶ä¸­Yomichanæ˜¯æœ€é‡è¦çš„ï¼Œå®ƒæ˜¯æˆ‘å€‘ä¸»è¦ç”¨ä¾†æŸ¥è©¢æ—¥æ–‡çš„å·¥å…·ï¼Œå¾Œé¢å…©å€‹å‰‡å¯ä»¥èµ·åˆ°è¼”åŠ©çš„ä½œç”¨ã€‚</p>
<h1 data-number="1" id="yomichan"><span class="header-section-number">1</span> Yomichan</h1>
<p><a href="https://foosoft.net/projects/yomichan/">Yomichan</a>æ˜¯ä¸€å€‹å¯ä»¥å¹«åŠ©æˆ‘å€‘åœ¨çœ‹æ—¥æ–‡ç¶²é çš„æ™‚å€™ï¼ŒæŸ¥è©¢å–®å­—çš„æ“´å……å¥—ä»¶ï¼Œåªè¦é¸å–ç¶²é ä¸Šçš„å­—ï¼Œå†æŒ‰ä¸‹Shiftéµï¼Œå°±å¯ä»¥é¡¯ç¤ºé€™å€‹æ—¥æ–‡å–®å­—çš„æ„æ€ï¼Œååˆ†æ–¹ä¾¿ã€‚</p>
<p><img src="../images/yomichan.png"></p>
<p>åœ¨å®‰è£å®ŒYomichanä¹‹å¾Œï¼Œæ˜¯æ²’æœ‰ä»»ä½•å­—å…¸çš„ï¼Œæˆ‘å€‘å¿…é ˆå…ˆæ‰‹å‹•ä¸‹è¼‰å­—å…¸æª”å¾Œï¼Œå†åšä¸€å€‹åŒ¯å…¥çš„å‹•ä½œã€‚<a href="https://foosoft.net/projects/yomichan/#dictionaries">å­—å…¸æª”</a>å¯ä»¥åœ¨å®˜ç¶²æ‰¾åˆ°ã€‚</p>
<p>æˆ‘ç›®å‰ä½¿ç”¨çš„æœ‰ï¼š</p>
<ul>
<li>JMDict (Englsih)</li>
<li>JMnedict</li>
<li>Kanjium Pitch Accents</li>
</ul>
<p>JMDictæ˜¯ä¸€å€‹å…è²»çš„æ—¥è‹±å­—å…¸ï¼Œå¹¾ä¹çµ•å¤§éƒ¨åˆ†çš„å­—éƒ½å¯ä»¥æ‰¾åˆ°ã€‚JMnedictå‰‡æ˜¯å°ˆé–€æ”¶éŒ„åå­—çš„å­—å…¸ï¼Œä¾‹å¦‚å§“æ°ã€äººåæˆ–ç”¢å“åç¨±ç­‰ç­‰ï¼Œéƒ½å¯ä»¥åœ¨é€™å€‹å­—å…¸æ‰¾åˆ°å”¸æ³•ã€‚Kanjiumå‰‡æ˜¯é‡å°æ—¥æ–‡è²èª¿çš„éƒ¨åˆ†ï¼Œå®ƒæœƒå¹«åŠ©é¡¯ç¤ºå‡ºé€™å€‹å–®å­—é‡éŸ³çš„ä½ç½®ã€‚</p>
<p>é€™äº›å­—å…¸ä¸‹è¼‰ä¸‹ä¾†ä¹‹å¾Œï¼Œæ˜¯ä¸€å€‹zipæª”ï¼Œä¸éœ€è¦è§£å£“ç¸®ï¼Œç›´æ¥åˆ°Yomichançš„ç®¡ç†é é¢åŒ¯å…¥å°±å¯ä»¥ä½¿ç”¨äº†ã€‚</p>
<p><img src="../images/yomichan2.png"></p>
<p>å¦å¤–é™¤äº†ä¸Šè¿°è³‡æºå¤–ï¼Œä¹Ÿå¯ä»¥åŒ¯å…¥å…¶å®ƒçš„è‡ªè£½å­—å…¸æª”ï¼Œæœ‰èˆˆè¶£çš„äººå¯ä»¥åˆ°é€™å€‹<a href="https://learnjapanese.moe/">ç¶²ç«™</a>æ‰¾å°‹å…¶ä»–è³‡æºã€‚</p>
<h1 data-number="2" id="absolute-enable-right-click-copy"><span class="header-section-number">2</span> Absolute Enable Right Click &amp;
Copy</h1>
<p>æœ‰äº›ç¶²é æœƒç¦æ­¢æˆ‘å€‘é¸å–ä¸Šé¢çš„æ–‡å­—ï¼Œä¾‹å¦‚æ­Œè©ç¶²ç«™æˆ–æ˜¯ä¸€äº›å½±éŸ³ä¸²æµå¹³å°ã€‚ä¸èƒ½é¸å–çš„è©±ï¼Œæˆ‘å€‘å°±ä¸èƒ½åˆ©ç”¨Yomichanä¾†å¹«å¿™é–±è®€äº†ï¼Œé€™æ™‚å€™ï¼Œå°±æ˜¯é€™å€‹æ“´å……å¥—ä»¶å‡ºå ´çš„æ™‚å€™äº†ã€‚</p>
<p>åœ¨å®‰è£ä¹‹å¾Œï¼Œåªè¦å•Ÿå‹•é€™å€‹æ“´å……å¥—ä»¶çš„<code>Enable Copy</code>åŠŸèƒ½ï¼Œå°±å¯ä»¥åœ¨åŸæœ¬ä¸èƒ½é¸å–çš„ç¶²é æ­£å¸¸é¸å–äº†ï¼</p>
<p><img src="../images/copyText.png"></p>
<h1 data-number="3" id="google-search---geolocation-language-change"><span class="header-section-number">3</span> Google Search - Geolocation &amp;
Language Change</h1>
<p>ä¸çŸ¥é“å¤§å®¶æœƒä¸æœƒè·Ÿæˆ‘æœ‰ä¸€æ¨£çš„å›°æ“¾â€”â€”è¦ºå¾—Googleè¶Šä¾†è¶Šé›£ç”¨ï¼Œç¾åœ¨å³ä½¿æ˜¯æœå°‹è‹±æ–‡å–®å­—æˆ–æ—¥æ–‡æ¼¢å­—ï¼Œä¹Ÿç¸½æ˜¯ä¸€å †ä¸­æ–‡çš„å…§å®¹è¾²å ´ç¶²é æ’åœ¨å‰é¢ï¼Œå¯¦åœ¨è »å›°æ“¾çš„ï¼Œæƒ³è¦æ‰¾å€‹åœ¨åœ°çš„çµæœï¼Œå»å¹¾ä¹æ‰¾ä¸åˆ°ã€‚</p>
<p>é‚„å¥½ï¼Œçµ‚æ–¼ç™¼ç¾é€™å€‹æ“´å……åŠŸèƒ½ï¼Œå¯ä»¥è¼•é¬†çš„æ”¹è®Šæœå°‹æ™‚å€™çš„åœ°ç†ä½ç½®å’Œèªè¨€è¨­å®šã€‚</p>
<p><img src="../images/location.png"></p>
<p>å®‰è£å®Œå¾Œï¼Œåœ¨Googleçš„æœå°‹é é¢ï¼Œæœƒå¤šå‡ºä¸€å€‹Locationçš„æŒ‰éˆ•ï¼Œåªè¦é»ä¸‹å»ï¼Œå°±å¯ä»¥é¸æ“‡è¦è½‰æ›çš„åœ°å€å’Œèªè¨€äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼</p>
<h1 data-number="4" id="å°çµ"><span class="header-section-number">4</span> å°çµ</h1>
<p>é€™æ˜¯æˆ‘æœ€è¿‘è¦ºå¾—éä»‹ç´¹ä¸å¯çš„æ“´å……åŠŸèƒ½ï¼Œæœ‰å…¶å®ƒå¥½ç”¨çš„æ“´å……åŠŸèƒ½ï¼Œä¹Ÿè«‹æ¨è–¦ï¼</p></div></div></section></article><comment><script async="async" crossorigin="anonymous" data-category="General" data-category-id="DIC_kwDOD5Bpa84COAIg" data-emit-metadata="0" data-input-position="top" data-lang="en" data-mapping="pathname" data-reactions-enabled="0" data-repo="onemouth/onemouth.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkyNjExMjI0MTE=" data-theme="light" src="https://giscus.app/client.js"></script><script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script></comment></div></main>
]]></summary></entry></feed>